"use strict";(self.webpackChunk_byted_editor=self.webpackChunk_byted_editor||[]).push([[64],{84075:function(e,t,n){n.d(t,{Z:function(){return F},p:function(){return B}});var r,a,l,o=n(22142),i=n(5635),c=n(80863),s=n(26840),d=n(78296),u=n(50509),p=n(62255),m=n(70072),f=n(42761),A=n(10155),y=n(33058),g=n(19104),v=n(40985),h=["title","titleId"];function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b.apply(this,arguments)}var E=function(e,t){var n=e.title,i=e.titleId,c=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,h);return o.createElement("svg",b({width:17,height:16,viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":i},c),n?o.createElement("title",{id:i},n):null,r||(r=o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.01157 2C10.6473 2 12.8075 4.03361 13.0042 6.61527C14.4831 7.23503 15.5224 8.69554 15.5224 10.3984C15.5224 12.5454 13.8704 14.3071 11.7665 14.4852L11.767 14.5H4.25615L4.25565 14.4851C2.1522 14.3065 0.500732 12.5451 0.500732 10.3984C0.500732 8.69554 1.54001 7.23503 3.01976 6.61484C3.21568 4.03361 5.37579 2 8.01157 2ZM8.01157 3.3C6.13623 3.3 4.57108 4.69686 4.3373 6.52272L4.31791 6.71309L4.25774 7.50585L3.5236 7.81353C2.4895 8.24695 1.80261 9.25926 1.80261 10.3984C1.80261 11.7976 2.83462 12.9699 4.19431 13.1699L4.36593 13.1898L4.49449 13.2H11.5266L11.6565 13.1898C13.0426 13.0725 14.1304 11.9514 14.2152 10.5721L14.2205 10.3984C14.2205 9.32263 13.6079 8.35988 12.6694 7.89144L12.5004 7.81399L11.7665 7.50642L11.7061 6.71391C11.5598 4.79495 9.95159 3.3 8.01157 3.3ZM10.44 7.7772C10.3224 7.66038 10.1812 7.60193 10.0164 7.60193L10.0164 7.60184L10.0169 7.6C9.85169 7.6 9.70978 7.66029 9.5913 7.77895L7.47859 9.89326L6.63229 9.04792C6.51381 8.92926 6.37216 8.87081 6.20682 8.87081C6.04174 8.87081 5.90114 8.92926 5.78336 9.04608C5.6669 9.1629 5.6081 9.30355 5.6081 9.46787C5.6081 9.63762 5.6662 9.77819 5.78099 9.89326L7.05268 11.1585C7.16773 11.2735 7.30938 11.332 7.4778 11.332C7.64367 11.332 7.78409 11.2735 7.89853 11.1585L10.4372 8.62438C10.5556 8.50572 10.6153 8.36322 10.6153 8.19899C10.6153 8.03467 10.5564 7.89402 10.44 7.7772Z",fill:"#424348"})),a||(a=o.createElement("mask",{id:"mask0","mask-type":"alpha",maskUnits:"userSpaceOnUse",x:0,y:2,width:16,height:13},o.createElement("path",{fillRule:"evenodd",clipRule:"evenodd",d:"M8.01157 2C10.6473 2 12.8075 4.03361 13.0042 6.61527C14.4831 7.23503 15.5224 8.69554 15.5224 10.3984C15.5224 12.5454 13.8704 14.3071 11.7665 14.4852L11.767 14.5H4.25615L4.25565 14.4851C2.1522 14.3065 0.500732 12.5451 0.500732 10.3984C0.500732 8.69554 1.54001 7.23503 3.01976 6.61484C3.21568 4.03361 5.37579 2 8.01157 2ZM8.01157 3.3C6.13623 3.3 4.57108 4.69686 4.3373 6.52272L4.31791 6.71309L4.25774 7.50585L3.5236 7.81353C2.4895 8.24695 1.80261 9.25926 1.80261 10.3984C1.80261 11.7976 2.83462 12.9699 4.19431 13.1699L4.36593 13.1898L4.49449 13.2H11.5266L11.6565 13.1898C13.0426 13.0725 14.1304 11.9514 14.2152 10.5721L14.2205 10.3984C14.2205 9.32263 13.6079 8.35988 12.6694 7.89144L12.5004 7.81399L11.7665 7.50642L11.7061 6.71391C11.5598 4.79495 9.95159 3.3 8.01157 3.3ZM10.44 7.7772C10.3224 7.66038 10.1812 7.60193 10.0164 7.60193L10.0164 7.60184L10.0169 7.6C9.85169 7.6 9.70978 7.66029 9.5913 7.77895L7.47859 9.89326L6.63229 9.04792C6.51381 8.92926 6.37216 8.87081 6.20682 8.87081C6.04174 8.87081 5.90114 8.92926 5.78336 9.04608C5.6669 9.1629 5.6081 9.30355 5.6081 9.46787C5.6081 9.63762 5.6662 9.77819 5.78099 9.89326L7.05268 11.1585C7.16773 11.2735 7.30938 11.332 7.4778 11.332C7.64367 11.332 7.78409 11.2735 7.89853 11.1585L10.4372 8.62438C10.5556 8.50572 10.6153 8.36322 10.6153 8.19899C10.6153 8.03467 10.5564 7.89402 10.44 7.7772Z",fill:"white"}))),l||(l=o.createElement("g",{mask:"url(#mask0)"},o.createElement("rect",{width:16.0231,height:16,fill:"#CDCFD9"}))))},w=(0,o.forwardRef)(E),P=(n.p,n(51828)),S=n(3197),x=n(51514),Z=n(71092),O=n(22142),k=Object.defineProperty,C=Object.defineProperties,j=Object.getOwnPropertyDescriptors,I=Object.getOwnPropertySymbols,z=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable,N=(e,t,n)=>t in e?k(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,V=(e,t)=>{for(var n in t||(t={}))z.call(t,n)&&N(e,n,t[n]);if(I)for(var n of I(t))L.call(t,n)&&N(e,n,t[n]);return e},D=(e,t)=>C(e,j(t));const B={0:"互动落地页",1:void 0,2:"轻互动",3:"直出互动",4:"互动视频"};var F=(0,o.memo)((({disabled:e=!1,readOnly:t=!1})=>{const{dispatch:n,getState:r}=(0,f.oR)(),a=(0,f.v9)((({userinfo:e})=>{var t;return(null!=(t=null==e?void 0:e.roles)?t:0)>0})),l=(0,f.v9)((({project:e})=>e.name)),[h,b]=(0,o.useState)(""),[E,k]=(0,o.useState)(!1),[C,j]=(0,o.useState)(""),I=(0,g.useSettings)("typeOfPlay")||0,z=(0,x.FJ)("<direct_play>");(0,Z.Z)("SaveStatus",b),(0,o.useEffect)((()=>{j(l),document.title=l||"万能编辑器"}),[l]),(0,o.useEffect)((()=>{E||C===l||(C.trim()?n((0,g.changeProps)([0],{name:C.trim()})):j(l))}),[E]);const{token:L}=i.Z.useToken(),N=O.createElement(c.Z,{color:L.colorPrimary},B[I]);return O.createElement("div",{className:(0,v.xG)({[`${P.Z}-content`]:2})},O.createElement("div",null,t&&O.createElement(s.Z,{title:"只读模式下所有项目改动仅为本地暂存，若需同步线上，请另存版本",placement:"bottom"},O.createElement(c.Z,{color:L.colorPrimary,onClick:()=>{if(a){const e=new URL(location.href);e.searchParams.set("readonly","0"),location.href=e.href}}},a?"只读，申请编辑":"只读")),!t&&([0,3].includes(I)&&z?O.createElement(d.Z,{overlay:O.createElement(u.Z,{onClick:()=>{return void 0,null,e=function*(){const{project:{id:e,settings:{typeOfPlay:t}}}=r(),{projectContent:n}=yield(0,S.GG)(e),a=JSON.parse(n);yield(0,S.ty)({id:e,typeOfPlay:0===t?3:0,projectContent:JSON.stringify(D(V({},a),{sceneOrders:a.sceneOrders.map((e=>0===t?e===a.settings.loading?a.settings.playable:e:3===t&&e===a.settings.playable?a.settings.loading:e)),settings:D(V({},a.settings),{typeOfPlay:0===t?3:0})}))}),location.reload()},new Promise(((t,n)=>{var r=t=>{try{l(e.next(t))}catch(e){n(e)}},a=t=>{try{l(e.throw(t))}catch(e){n(e)}},l=e=>e.done?t(e.value):Promise.resolve(e.value).then(r,a);l((e=e.apply(undefined,null)).next())}));var e}},0===I&&O.createElement(u.Z.Item,{key:"0"},"转化为直出互动"),3===I&&O.createElement(u.Z.Item,{key:"3"},"转化为互动落地页"))},N):N),E?O.createElement(p.Z,{className:`${P.Z}-input`,value:C,autoFocus:!0,maxLength:20,onChange:({target:{value:e}})=>j(e),onBlur:()=>{k(!1)},onPressEnter:()=>{k(!1)}}):O.createElement("p",{style:{margin:"0"}},C),!e&&O.createElement(s.Z,{title:"编辑项目名称",placement:"bottom"},O.createElement(m.Z,{type:"text",size:"small",style:{display:E?"none":"block",border:"none",boxShadow:"none"},icon:O.createElement(y.Z,{component:A.Z,className:`${P.Z}-edit`}),onClick:()=>{k(!0)}}))),!t&&O.createElement("div",{style:{color:"#CDCFD9"}},O.createElement(w,null),h))}))},36551:function(e,t,n){n.d(t,{Z:function(){return f}});var r=n(22142),a=n(45858),l=n(70072),o=n(51828),i=Object.defineProperty,c=Object.defineProperties,s=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertySymbols,u=Object.prototype.hasOwnProperty,p=Object.prototype.propertyIsEnumerable,m=(e,t,n)=>t in e?i(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;function f(e){var t=e,{dot:n=!1,type:i,icon:f,disabled:A,children:y,loading:g,onClick:v}=t,h=((e,t)=>{var n={};for(var r in e)u.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&d)for(var r of d(e))t.indexOf(r)<0&&p.call(e,r)&&(n[r]=e[r]);return n})(t,["dot","type","icon","disabled","children","loading","onClick"]);const[b,E]=(0,r.useState)(!1);return r.createElement("div",(w=((e,t)=>{for(var n in t||(t={}))u.call(t,n)&&m(e,n,t[n]);if(d)for(var n of d(t))p.call(t,n)&&m(e,n,t[n]);return e})({},h),P={className:`${o.Z}-btn`},c(w,s(P))),r.createElement(a.Z,{dot:n},r.createElement(l.Z,{type:i,icon:f,disabled:Boolean(A||b||g),loading:b||g,onClick:(...e)=>{if(!v)return;const t=v(...e);t instanceof Promise&&(E(!0),t.finally((()=>{E(!1)})))}})),r.createElement("span",null,y));var w,P}},34043:function(e,t,n){n.d(t,{Z:function(){return ee}});var r,a=n(22142),l=n(76041),o=n(65529),i=n(10618),c=n(54588),s=n(78930),d=n(58769),u=n(21703),p=n(32078),m=n(68961),f=n(78296),A=n(46927),y=n(61754),g=n(26840),v=n(70072),h=["title","titleId"];function b(){return b=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},b.apply(this,arguments)}var E=function(e,t){var n=e.title,l=e.titleId,o=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,h);return a.createElement("svg",b({width:32,height:32,viewBox:"0 0 32 32",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":l},o),n?a.createElement("title",{id:l},n):null,r||(r=a.createElement("g",{opacity:.6},a.createElement("path",{d:"M32 0H0V32H32V0Z",fill:"white",fillOpacity:.01}),a.createElement("path",{d:"M16 29.3333C23.3638 29.3333 29.3333 23.3638 29.3333 16C29.3333 8.63619 23.3638 2.66666 16 2.66666C8.63616 2.66666 2.66663 8.63619 2.66663 16C2.66663 23.3638 8.63616 29.3333 16 29.3333Z",fill:"white",stroke:"white",strokeWidth:2.66667,strokeLinejoin:"round"}),a.createElement("path",{d:"M19.7712 12.2287L12.2288 19.7712",stroke:"#333333",strokeWidth:2.66667,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("path",{d:"M12.2288 12.2287L19.7712 19.7712",stroke:"#333333",strokeWidth:2.66667,strokeLinecap:"round",strokeLinejoin:"round"}))))},w=(0,a.forwardRef)(E),P=(n.p,n(70761)),S=n(7910);const x=[{title:"Android",resolution:[680,314],android:!0,x:!0},{title:"iPhone SE",resolution:[667,375],x:!1},{title:"iPhone 12",resolution:[680,314],x:!0},{title:"iPad Mini",resolution:[720,540]}],Z=(e,t)=>3===e&&(0,S.cM)({release:!0})?x.slice(0,-1):t?x.concat({title:"原始尺寸",resolution:t}):x;var O=n(65164),k=n(62732),C=n(21876),j=n(54520),I=n(34450),z=n.n(I),L=n(1434),N=n.n(L);const V={nodes:[{id:"start",label:"start",x:100,y:100}]};var D=n(92947),B=n(74716),F=n(40985),T=({setEventTracking:e,trackedEvents:t,setTrackedEvents:n})=>{const r=(0,a.useRef)(null),{currentId:l,addNode:o,clear:i,amplify:c,minify:s}=(e=>{const[t,n]=(0,a.useState)(""),r=(0,a.useRef)(null);return N().registerBehavior("double-finger-drag-canvas",{getEvents:()=>({wheel:"onWheel"}),onWheel:e=>{var t,n,a,l,o;if(e.ctrlKey){const o=(null==(t=r.current)?void 0:t.get("canvas")).getPointByClient(e.clientX,e.clientY);let i=null!=(a=null==(n=r.current)?void 0:n.getZoom())?a:0;e.wheelDelta>0?i+=.05*i:i-=.05*i,null==(l=r.current)||l.zoomTo(i,{x:o.x,y:o.y})}else{const t=e.deltaX||e.movementX,n=e.deltaY||e.movementY;null==(o=r.current)||o.translate(-t,-n)}e.preventDefault()}}),(0,a.useEffect)((()=>{var t,a;r.current=new(N().Graph)({container:e.current,width:630,height:190,layout:{rankdir:"LR",align:"UL",controlPoints:!0,nodesepFunc:()=>1,ranksepFunc:()=>1},modes:{default:["double-finger-drag-canvas","drag-canvas","drag-node"]},defaultNode:{size:[120,30],type:"rect",labelCfg:{style:{fill:"#333"}},style:{lineWidth:1,radius:15,stroke:"#ebebeb",fill:"#fafafa"}},defaultEdge:{type:"polyline",size:1,style:{stroke:"#e2e2e2",endArrow:{path:"M 0,0 L 8,4 L 8,-4 Z",fill:"#e2e2e2"},radius:20,lineAppendWidth:8},labelCfg:{refY:10}},nodeStateStyles:{click:{fill:"#0672FF"}},edgeStateStyles:{click:{stroke:"#0672FF",endArrow:{path:"M 0,0 L 8,4 L 8,-4 Z",fill:"#0672FF"}},last:{stroke:"#6ABF40",endArrow:{path:"M 0,0 L 8,4 L 8,-4 Z",fill:"#6ABF40"}}}}),r.current.data(V),r.current.render(),null==(t=r.current)||t.on("node:click",(e=>{const t=e.item;l(t)})),null==(a=r.current)||a.on("edge:click",(e=>{var t;const n=e.item;n.toFront(),null==(t=r.current)||t.paint(),l(n)}));const l=e=>{var t,a;null==(t=r.current)||t.findAllByState("node","click").forEach((e=>{var t,n;null==(t=r.current)||t.setItemState(e,"click",!1),null==(n=r.current)||n.updateItem(e,{labelCfg:{style:{fill:"#333"}}})})),null==(a=r.current)||a.findAllByState("edge","click").forEach((e=>{var t;null==(t=r.current)||t.setItemState(e,"click",!1)})),n((t=>{var a,l;return e._cfg.id!==t?(null==(a=r.current)||a.updateItem(e,{labelCfg:{style:{fill:"#fefefe"}}}),n(e._cfg.id),null==(l=r.current)||l.setItemState(e,"click",!0),e._cfg.id):""}))};return()=>{var e;null==(e=r.current)||e.destroy(),r.current=null}}),[e]),{currentId:t,addNode(e,t,n,a){var l,o,i,c,s,d,u,p,m,f,A,y,g,v,h,b,E,w,P,S;const x=null==(l=r.current)?void 0:l.getNodes();0===(null==x?void 0:x.length)&&(null==(o=r.current)||o.data(V),null==(i=r.current)||i.render());const Z=null==(c=r.current)?void 0:c.findById(e),O=null==(s=r.current)?void 0:s.findById(t),k=null!=(d=null==Z?void 0:Z.get("model").x)?d:100,C=null!=(u=null==O?void 0:O.get("model").x)?u:100,j=null!=(p=null==Z?void 0:Z.get("model").y)?p:100,I=null!=(m=null==O?void 0:O.get("model").y)?m:100;if(O){O.update({label:`${t}\n展示数:${n}`});const l=null==(f=r.current)?void 0:f.findById(`edge_${e}_${t}`),o=null==(A=r.current)?void 0:A.findById(`edge_${t}_${e}`);l||null==(y=r.current)||y.addItem("edge",{id:`edge_${e}_${t}`,source:e||"start",target:t,label:e?`${a}%`:"",type:I-j==0?"quadratic":"polyline",controlPoints:I-j==0?[{x:(C+k)/2,y:o?I-80:I+80}]:[]})}else{const l=null==Z?void 0:Z.getNeighbors("target");let o=0;for(let e=0;e<(null==l?void 0:l.length);e++)(null==(g=l[e])?void 0:g.get("model").y)>o&&(o=null==(v=l[e])?void 0:v.get("model").y);null==(h=r.current)||h.addItem("node",{id:t,label:`${t}\n展示数:${n}`,x:k+180,y:o+100}),null==(b=r.current)||b.addItem("edge",{id:`edge_${e}_${t}`,source:e||"start",label:e?`${a}%`:"",target:t,type:"line"})}null==(E=r.current)||E.findAllByState("edge","last").forEach((e=>{var t;null==(t=r.current)||t.setItemState(e,"last",!1)}));const z=null==(w=r.current)?void 0:w.findById(`edge_${e}_${t}`);null==(P=r.current)||P.setItemState(z,"last",!0),z.toFront(),null==(S=r.current)||S.paint()},clear(){var e;null==(e=r.current)||e.clear()},amplify(){var e;null==(e=r.current)||e.zoom(2)},minify(){var e;null==(e=r.current)||e.zoom(.5)}}})(r),d=(0,a.useRef)(0),[u,p]=(0,a.useState)({});(0,a.useEffect)((()=>{const e=t.filter((({eventName:e,params:t})=>"enterSection"===e&&"loading"!==t.current_section&&"loading"!==t.section));e.length<d.current&&(d.current=0,p({}),i());for(let t=e.length-d.current-1;t>=0;t--){const{section:n,current_section:r}=e[t].params,a=u;a[n]?a[n]+=1:a[n]=1,p(a),o(r,n,a[n],(e.filter((e=>e.params.current_section===r&&e.params.section===n)).length/(a[r]||1)*100).toFixed(0))}d.current=e.length}),[t]);const m=[{title:"事件名称",dataIndex:"eventName",key:"eventName",width:"20%",render:e=>a.createElement("div",null,e)},{title:"间隔时长(s)",dataIndex:"duration",key:"duration",width:"20%",render:e=>a.createElement("div",null,z()(e).format("ss.SSS"),"s")},{title:"当前环节",dataIndex:"params",key:"current_section",width:"20%",render:e=>{var t;return a.createElement("div",null,null!=(t=null==e?void 0:e.current_section)?t:"-")}},{title:"目标环节",dataIndex:"params",key:"section_remark",width:"20%",render:e=>{var t;return a.createElement("div",{style:{whiteSpace:"normal",wordBreak:"break-all",wordWrap:"break-word"}},null!=(t=null==e?void 0:e.section)?t:"-",null==e?void 0:e.section_remark)}},{title:"位置",dataIndex:"params",key:"area_remark",width:"20%",render:e=>{var t;return a.createElement("div",{style:{whiteSpace:"normal",wordBreak:"break-all",wordWrap:"break-word"}},null!=(t=null==e?void 0:e.area)?t:"-",null==e?void 0:e.area_remark)}}];return a.createElement(C.Z,{title:"埋点日志",placement:"right",open:!0,width:700,mask:!1,onClose:()=>{e(!1)},rootStyle:{userSelect:"none"},headerStyle:{border:"none"}},a.createElement("div",{style:{border:"1px solid #dbdcdd"}},a.createElement("div",{style:{height:"50px",width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #dbdcdd",padding:"0 5px",boxSizing:"border-box"}},a.createElement("h4",null,"漏斗图"),a.createElement("div",null,a.createElement(v.Z,{icon:a.createElement(D.Z,null),onClick:()=>c()}),a.createElement(v.Z,{icon:a.createElement(B.Z,null),style:{margin:"0 5px"},onClick:()=>s()}),a.createElement(v.Z,{onClick:()=>{n([])}},"删除历史记录"))),a.createElement("div",{ref:r,style:{width:"640px",height:"180px",overflow:"hidden"}})),a.createElement("div",{style:{border:"1px solid #dbdcdd",marginTop:"20px"}},a.createElement("div",{style:{height:"50px",width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center",borderBottom:"1px solid #dbdcdd",padding:"0 5px",boxSizing:"border-box"}},a.createElement("h4",null,"埋点详情"),a.createElement(v.Z,{onClick:()=>{(0,F.lm)(new Blob([JSON.stringify(t)]),"eventTracking.json")}},"导出")),a.createElement(j.Z,{rowKey:"id",columns:m,scroll:{y:500},dataSource:(()=>{if(""===l)return t;if(l.startsWith("edge")){const e=l.split("_")[1],n=l.split("_")[2];return t.filter((t=>{var r,a;return(null==(r=t.params)?void 0:r.current_section)===e&&(null==(a=t.params)?void 0:a.section)===n}))}return t.filter((e=>{var t;return(null==(t=e.params)?void 0:t.current_section)===l}))})(),pagination:!1})))},M=n(33058),R=n(93955),W=n(8411),U=Object.defineProperty,q=Object.getOwnPropertySymbols,G=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable,J=(e,t,n)=>t in e?U(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,H=(e,t)=>{for(var n in t||(t={}))G.call(t,n)&&J(e,n,t[n]);if(q)for(var n of q(t))X.call(t,n)&&J(e,n,t[n]);return e};const K=(0,k.iv)({flex:1}),Q=(0,k.iv)({cursor:"pointer"}),Y=(0,k.iv)({".ant-select-selection-item":{fontWeight:"normal"},".ant-modal-content":{borderRadius:"8px",paddingLeft:"16px",paddingRight:"16px"},".ant-modal-footer":{color:"#3955f6"}}),$=(0,k.iv)({display:"flex",alignItems:"center"}),_=(0,k.iv)({display:"flex",justifyContent:"flex-start"});function ee({httpUrl:e,originSize:t,platform:n,typeOfPlay:r,onClose:d}){const g=Z(r,t),[v=0,h]=(0,O.Z)("useStorage.previewer.device",0),b=v%g.length,[E=!0,x]=(0,O.Z)("useStorage.previewer.landscape",!0),[k,C]=(0,O.Z)("popup.previewer.playable.mask",!1),[j,I]=(0,a.useState)(!1),[z,L]=(0,a.useState)([]),N=(0,a.useRef)(Date.now()),[V,D]=(0,a.useState)(0),[B,F]=(0,a.useState)(!1),M=(0,a.useRef)(null);(0,a.useLayoutEffect)((()=>{N.current=Date.now()}),[V,b]),(0,a.useEffect)((()=>{0===z.length&&D((e=>e+1))}),[z]);const U=(0,a.useMemo)((()=>{const t=new URL(e);return B&&t.searchParams.set("debug","true"),t.searchParams.set("hidden_event_console","1"),t.href}),[e,B]);let[q,G]=g[b].resolution;const{android:X}=g[b];return E||3===r||([q,G]=[G,q]),a.createElement(a.Fragment,null,a.createElement(p.Z,{open:!0,centered:!0,destroyOnClose:!0,closable:!1,width:G+32,bodyStyle:{padding:0,margin:0,height:q,width:G,borderRadius:"8px"},wrapClassName:Y,style:j?{transform:"translateX(-350px)"}:{},onCancel:d,title:a.createElement("div",{className:$},a.createElement("div",{className:K},a.createElement(m.Z,{defaultValue:b,style:{maxWidth:120},onChange:e=>{h(e)}},g.map((({title:e},t)=>a.createElement(m.Z.Option,{key:t,value:t},e))))),3===r&&a.createElement(ne,{title:"互动直出遮罩",Icon:R.z,clicked:k,onClick:()=>{C((e=>!e)),D((e=>e+1))}}),3!==r&&a.createElement(ne,{title:"切换横屏/竖屏",Icon:l.Z,onClick:()=>{x((e=>!e)),D((e=>e+1))}}),a.createElement(ne,{title:"重新播放",Icon:e=>a.createElement(o.Z,H({theme:"filled"},e)),onClick:()=>{D((e=>e+1))}}),a.createElement(te,{iframe:M,iframeKey:`${b}:${V}`}),a.createElement(ne,{title:z.length>0?"埋点日志":"正在加载埋点数据···",Icon:z.length>0?e=>a.createElement(i.Z,H({theme:"filled"},e)):i.Z,onClick:()=>{z.length>0&&I(!0),(0,u.r)(u.G.EventTracking,null)}}),(0,S.cM)({release:!1})&&a.createElement(ne,{title:B?"关闭调试模式":"打开调试模式",Icon:e=>a.createElement(c.Z,H({theme:"filled"},e)),clicked:B,onClick:()=>{D((e=>e+1)),F(!B)}}),(()=>{const e=new URL(U);e.searchParams.set("refer","scan"),e.searchParams.set("is_playable","1");const t=(0,W.y)(e.href,{width:264});return!U.includes("type=preview")&&a.createElement(f.Z,{overlay:a.createElement(A.Z,{hoverable:!0,bodyStyle:{width:"auto",textAlign:"center",padding:16}},a.createElement("img",{src:t,alt:"预览二维码"}),a.createElement("div",null,"请用「抖音」App扫码预览"),a.createElement("div",{style:{color:"#999",fontSize:12,paddingTop:3}},"「抖音」请用21.6.0以上版本扫码")),children:ne({title:"新标签打开",Icon:s.Z,href:e.href})})})()),footer:a.createElement("div",{className:_},a.createElement("a",{href:"https://bytedance.feishu.cn/docs/doccnoaMwBBGL5myLuHzjkNppf1",target:"_blank"},"如何适配各机型？"))},a.createElement(P.c,{ref:M,width:G,height:q,onAndroid:X,key:`${b}:${V}`,httpUrl:n?`${U}`:`${U}&recorder=true&previewMode=true`,mask12:k&&3===r?q/G>2:void 0,onEventTracked:e=>{L((t=>{const n=[e].concat(t);return"loadMainScene"===e.eventName&&n.slice(0,3).reduce(((e,{duration:t})=>e+t),0)>5e3&&y.ZP.warning("进入首场景的时长超过5秒"),n}))},onReplay:()=>{D((e=>e+1))}}),a.createElement("div",{style:{position:"absolute",right:-16,top:0,transform:"translateX(100%)",display:"flex"}},a.createElement(w,{className:Q,onClick:()=>{d()}}))),j&&a.createElement(T,{trackedEvents:z,setEventTracking:I,setTrackedEvents:L}))}const te=({iframe:e,iframeKey:t})=>{const[n,r]=(0,a.useState)(!1);(0,a.useEffect)((()=>{const e=e=>{const{type:t,status:n}=e.data;"StartRecord"===t?n?r(!0):y.ZP.error("无法录屏"):"StopRecord"===t&&(n?r(!1):y.ZP.error("无法停止录屏"))};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]),(0,a.useEffect)((()=>{n&&r(!1)}),[t]);const l=(0,k.iv)({animation:`${k.F4`
      from {
        opacity:1;
      }
      50% {
        opacity:0.5;
      }
      to {
        opacity:1;
      }
    `} 1s ease infinite`});return a.createElement(ne,{title:n?"停止录制":"录制作品",Icon:e=>a.createElement(d.Z,H({theme:"filled"},e)),className:n?l:void 0,clicked:n,onClick:()=>{var t,r,a,l;n?null==(r=null==(t=e.current)?void 0:t.contentWindow)||r.postMessage("StopRecord","*"):null==(l=null==(a=e.current)?void 0:a.contentWindow)||l.postMessage("StartRecord","*")}})},ne=({title:e,onClick:t,clicked:n,Icon:r,className:l,href:o})=>a.createElement(g.Z,{title:e,placement:"top",mouseEnterDelay:.5},a.createElement(v.Z,{href:o,target:"_blank",className:l,type:n?"link":"text",icon:a.createElement(M.Z,{component:r}),onClick:t}))},70761:function(e,t,n){n.d(t,{c:function(){return E}});var r=n(22142),a=n.p+"images/606b68654ef41267a441.png",l=n(62732),o=n.p+"images/955901cb3b0e1b477304.png",i=n.p+"images/76818fe45ddcc88e2830.png",c=n.p+"images/f598d4569bab0ab39642.png",s=n.p+"images/8c92be92648d1b0fb0fe.png",d=n.p+"images/e4d37bcfb4a9c458e292.png",u=n.p+"images/985c7cc2d2b9bda83401.png",p=n.p+"images/dc0187e53bc1fdf098e6.png",m=n.p+"images/f598d4569bab0ab39642.png",f=Object.defineProperty,A=Object.defineProperties,y=Object.getOwnPropertyDescriptors,g=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,b=(e,t,n)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const E=(0,r.forwardRef)((({httpUrl:e,width:t,height:n,mask12:f,onAndroid:E=!1,onEventTracked:w,onReplay:P},S)=>{const[x,Z]=(0,r.useState)(null),[O,k]=(0,r.useState)(!0),C=(0,r.useRef)(null),j=(0,r.useRef)(Date.now()),[I,z]=(0,r.useState)(0);(0,r.useEffect)((()=>{if(I>0){const e=setTimeout((()=>z(0)),600);return()=>{clearTimeout(e)}}}),[I]),(0,r.useEffect)((()=>{const e=e=>{return void 0,t=[e],n=function*({data:e}){if(console.log("data:",e),"track"===e.type){const{current:l}=j,o=(j.current=Date.now())-l;"section0"===e.data.params.current_section&&(e.data.params.current_section="loading"),"section0"===e.data.params.section&&(e.data.params.section="loading"),"playableEnd"===e.data.eventName?Z((n=e=>{switch(e){case"download":return z((e=>e+1));case"replay":return P()}},r.createElement("img",{src:a,style:{width:"100%",height:"100%",objectFit:"cover",position:"absolute",left:0,top:0},onClick:({currentTarget:{offsetWidth:e,offsetHeight:t},nativeEvent:{offsetX:r,offsetY:a}})=>{const[l,o]=[1084,2104];if(o/l>t/e){const n=e*(o/l-t/e);t+=n,a+=n/2}else{const n=t*(l/o-e/t);e+=n,r+=n/2}const i=r/e*l,c=a/t*o;47<=i&&1456<=c&&i<=1040&&c<=1584&&n("download"),42<=i&&1635<=c&&i<=1035&&c<=1763&&n("replay")}}))):"enterSection"===e.data.eventName?"section_start"===e.data.params.section_type&&k(!1):"clickArea"===e.data.eventName&&1===e.data.params.convert_area&&z((e=>e+1)),w((t=((e,t)=>{for(var n in t||(t={}))v.call(t,n)&&b(e,n,t[n]);if(g)for(var n of g(t))h.call(t,n)&&b(e,n,t[n]);return e})({},e.data),A(t,y({duration:o}))))}var t,n},new Promise(((e,r)=>{var a=e=>{try{o(n.next(e))}catch(e){r(e)}},l=e=>{try{o(n.throw(e))}catch(e){r(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,l);o((n=n.apply(undefined,t)).next())}));var t,n};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]);const L=(0,r.useMemo)((()=>{const t=new URL(e),n=new URL(location.href).searchParams.get("x-tt-env"),r=t.searchParams.get("projectUrl");return n&&r&&t.searchParams.set("projectUrl",`${r}?x-tt-env=${n}`),t.href}),[e]);return r.createElement("div",{ref:C,className:"global-user-drag-none",style:{flexDirection:"column",position:"relative",borderRadius:"8px",overflow:"hidden",display:"flex",height:n,width:t}},(()=>{const e=r.createElement("iframe",{ref:S,title:"Preview",allow:"autoplay",style:{border:"none",display:"block",flex:"auto"},src:L});return void 0===f?r.createElement(r.Fragment,null,e,x):f?((e,t,n,a,l)=>r.createElement(r.Fragment,null,r.createElement("div",{style:{display:"flex",flex:"auto",flexDirection:"column",position:"relative"}},e,n),r.createElement("div",{style:{flex:"none",position:"relative"}},r.createElement("img",{src:s,style:{width:"100%",objectFit:"contain"},onClick:e=>e.stopPropagation()}),!t&&!n&&r.createElement("div",{style:{position:"absolute",transform:"translateY(-100%)",top:0,left:0}},r.createElement("img",{src:p,style:{width:"100%",objectFit:"contain",background:"#EF8CFF44"},onClick:e=>e.stopPropagation()}),r.createElement("img",{src:m,useMap:"#image_map_12",style:{width:"96%",objectFit:"contain",position:"absolute",top:"6%",left:"2%"},onClick:e=>{e.stopPropagation();const{currentTarget:{offsetWidth:t,offsetHeight:n},nativeEvent:{offsetX:r,offsetY:a}}=e,l=a/n*104,o=r/t*702;498<=o&&24<=l&&o<=678&&l<=80&&z((e=>e+1))}}))),r.createElement("img",{src:a?u:d,style:{width:"100%",objectFit:"contain",position:"absolute",background:"#EF8CFF44",top:0,left:0},onClick:e=>e.stopPropagation()})))(e,O,x,E):((e,t,n,a,l)=>r.createElement(r.Fragment,null,r.createElement("div",{style:{display:"flex",flex:"auto",flexDirection:"column",position:"relative"}},e,n),r.createElement("div",{style:{flex:"none",position:"absolute",left:0,bottom:0}},r.createElement("img",{src:o,style:{width:"100%",objectFit:"contain",background:"#EF8CFF44"},onClick:e=>e.stopPropagation()}),!t&&!n&&r.createElement("div",{style:{position:"absolute",transform:"translateY(-100%)",top:0,left:0}},r.createElement("img",{src:"data:image/png;base64,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",style:{width:"100%",objectFit:"contain",background:"#EF8CFF44"},onClick:e=>e.stopPropagation()}),r.createElement("img",{src:c,useMap:"#image_map_se",style:{width:"96%",objectFit:"contain",position:"absolute",top:0,left:"2%"},onClick:e=>{e.stopPropagation();const{currentTarget:{offsetWidth:t,offsetHeight:n},nativeEvent:{offsetX:r,offsetY:a}}=e,l=a/n*104,o=r/t*702;498<=o&&24<=l&&o<=678&&l<=80&&z((e=>e+1))}}))),r.createElement("img",{src:i,style:{width:"100%",objectFit:"contain",position:"absolute",background:"#EF8CFF44",top:0,left:0},onClick:e=>e.stopPropagation()})))(e,O,x)})(),I>0&&r.createElement("div",{className:(0,l.iv)({width:96,borderRadius:4,height:32,backgroundColor:"#333",padding:0,textAlign:"center",fontSize:12,color:"white",lineHeight:"32px",position:"absolute",bottom:"32%",left:"50%",transform:"translateX(-50%)"})},"模拟下载成功"))}))},74712:function(e,t,n){n.d(t,{E:function(){return w},Z:function(){return P}});var r=n(40985),a=n(22142),l=n(19104),o=n(3197),i=n(92187),c=n(89763),s=n(48837),d=n(36551),u=n(33058),p=n(34043),m=n(61754),f=Object.defineProperty,A=Object.defineProperties,y=Object.getOwnPropertyDescriptors,g=Object.getOwnPropertySymbols,v=Object.prototype.hasOwnProperty,h=Object.prototype.propertyIsEnumerable,b=(e,t,n)=>t in e?f(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,E=(e,t,n)=>new Promise(((r,a)=>{var l=e=>{try{i(n.next(e))}catch(e){a(e)}},o=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,o);i((n=n.apply(e,t)).next())}));const w=e=>{const[t,n]=(0,a.useState)("");return{previewUrl:t,updatePreviewUrl:()=>E(void 0,null,(function*(){const{id:t,editor:r}=e().project,{previewUrl:a}=yield(0,o.$9)(t),l=new URL(a);l.searchParams.set("version",s.RIKO_VERSION),r.readOnly&&(l.searchParams.set("type","preview"),l.searchParams.delete("projectUrl")),n(l.href)})),clearPreviewUrl:()=>n("")}};function P({disabled:e,getState:t,onSaving:n}){const o=(0,l.useSettings)("typeOfPlay"),[s,f]=(0,i.xx)("preview"),{previewUrl:P,updatePreviewUrl:S,clearPreviewUrl:x}=w(t),Z=(0,a.useCallback)((()=>{const{height:e=667,width:n=375}=t().project.settings,r=Math.min(667,e);return[r,r&&Math.floor(n*r/e)]}),[t]);return(0,l.useOnPostMessage)("ProjectState",(()=>{const{project:e}=t(),n=({editor:{prevState:e},scenes:t})=>e?t.concat(n(e).filter((({orderId:e})=>!t.some((t=>t.orderId===e))))):t;return a=((e,t)=>{for(var n in t||(t={}))v.call(t,n)&&b(e,n,t[n]);if(g)for(var n of g(t))h.call(t,n)&&b(e,n,t[n]);return e})({},e),l={scenes:n(e).map((e=>(0,r.GV)(e))).concat(e.customScripts)},A(a,y(l));var a,l})),(0,a.useEffect)((()=>{s&&!e?S():x()}),[s,e]),a.createElement(a.Fragment,null,a.createElement(d.Z,{icon:a.createElement(u.Z,{component:c.Z}),disabled:e,onClick:()=>E(this,null,(function*(){(0,r.r3)(r.GM.OperationButton,{type:"预览"});try{yield n("预览");const e=(0,l.checkPlayableAreaAll)(t().project);e&&m.ZP.warning(`${e}，请及时检查是否影响互动效果`),f(!0)}catch(e){m.ZP.error((null==e?void 0:e.message)||"无法生成预览链接")}}))},"预览"),P.length>0&&a.createElement(p.Z,{typeOfPlay:o,httpUrl:P,originSize:Z(),onClose:()=>f(!1)}))}},8411:function(e,t,n){n.d(t,{Y:function(){return l},y:function(){return o}});var r=n(22142),a=n(66362);const l=(...[e,t])=>{if(e){for(const t of["hidden_event_console=1"])e=e.replace(t,"");e=(e=>{const t=new URL(e);return t.searchParams.set("immersive_mode","1"),t.searchParams.set("is_test_tool","0"),t.searchParams.set("is_playable","1"),t.searchParams.set("refer","scan"),t.href})(e)}return o(e,t)},o=(e,t)=>{const[n,l]=(0,r.useState)("");return(0,r.useEffect)((()=>{e&&a.toDataURL(e,t).then((e=>{l(e)}))}),[e]),n}},39472:function(e,t,n){n.d(t,{Z:function(){return E}});var r=n(22142),a=n(2961),l=n(61754),o=n(32078),i=n(76151),c=n(28985),s=n(27086),d=n(33058),u=n(70072);function p({cancelDisabled:e,okDisabled:t,cancelText:n,okText:a,footer:l,onCancel:o,onOk:i}){const[c,s]=(0,r.useState)(!1);return r.createElement("div",{style:{display:"flex",alignItems:"center"}},r.createElement("div",{style:{flex:"auto",textAlign:"left"}},l),r.createElement(u.Z,{disabled:c||e,onClick:e=>{e.stopPropagation(),o(s)}},n),r.createElement(u.Z,{type:"primary",loading:c,disabled:c||t,onClick:e=>{e.stopPropagation(),i(s)}},a))}var m=n(40985),f=n(62732),A=Object.defineProperty,y=Object.getOwnPropertySymbols,g=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable,h=(e,t,n)=>t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,b=(e,t)=>{for(var n in t||(t={}))g.call(t,n)&&h(e,n,t[n]);if(y)for(var n of y(t))v.call(t,n)&&h(e,n,t[n]);return e};function E({onConfirm:e,onCancel:t,title:n,action:u,useStepHooks:A}){const[y,g]=(0,r.useState)({}),[v,h]=(0,r.useState)(0),[E]=a.Z.useForm(),w=A.map(((e,t)=>e(E,t===v))),P=r.createElement(p,{cancelText:v?"上一步":"取消",okText:v===w.length-1?u:"下一步",okDisabled:w[v].okDisabled,cancelDisabled:w[v].cancelDisabled,footer:w[v].footer,onCancel:()=>{v?h(v-1):t()},onOk:n=>{return r=this,null,a=function*(){try{n(!0);const r=yield E.validateFields(),a=yield w[v].mapValues(r);if(v<w.length-1)g((e=>b(b({},e),a))),h(v+1);else{const{result:n}=w[v];if(n){const{duration:e,afterSize:t}=n;e&&t&&(0,m.r3)(m.GM.CompressProduct,{size:+(t/1024/1024).toFixed(1),duration:+(e/1e3).toFixed(1)})}yield e(b(b({},y),a)),t()}}catch(e){l.ZP.error(e.message||`${u}'失败'`)}finally{n(!1)}},new Promise(((e,t)=>{var n=e=>{try{o(a.next(e))}catch(e){t(e)}},l=e=>{try{o(a.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(n,l);o((a=a.apply(r,null)).next())}));var r,a}});return r.createElement(o.Z,{open:!0,width:1e3,footer:P,title:n,closeIcon:r.createElement(d.Z,{component:s.Z}),onCancel:t},r.createElement(i.Z,{spinning:w[v].spinning,tip:w[v].spinTip},r.createElement(c.Z,{current:v,className:(0,f.iv)({marginTop:20,".ant-steps-item:last-child":{flex:1}}),onChange:e=>{e<v&&h(e)}},w.map((({title:e},t)=>r.createElement(c.Z.Step,{key:t,title:e,disabled:t>v})))),r.createElement("br",null),w[v].element))}},79761:function(e,t,n){n.d(t,{lC:function(){return Ue},ZP:function(){return We},Wq:function(){return Me},Ts:function(){return Re}});var r=n(22142),a=n(34394),l=n(32078),o=n(70072),i=n(28471),c=n(59719),s=n(33058),d=n(19104),u=n(71092),p=n(61754),m=n(98466),f=n(73760),A=Object.defineProperty,y=Object.defineProperties,g=Object.getOwnPropertyDescriptors,v=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,b=Object.prototype.propertyIsEnumerable,E=(e,t,n)=>t in e?A(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,w=(e,t)=>{for(var n in t||(t={}))h.call(t,n)&&E(e,n,t[n]);if(v)for(var n of v(t))b.call(t,n)&&E(e,n,t[n]);return e},P=(e,t)=>y(e,g(t)),S=(e,t,n)=>new Promise(((r,a)=>{var l=e=>{try{i(n.next(e))}catch(e){a(e)}},o=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,o);i((n=n.apply(e,t)).next())}));const x={imageQuality:10,videoQuality:10,audioQuality:10};var Z=(e,t,n,a={imageQuality:8,videoQuality:8,audioQuality:8})=>{const o=(0,r.useRef)(void 0),i=(0,d.useSettings)("typeOfPlay"),c=(0,d.useSettings)("category"),s=(0,d.useSettings)("hyruleJson"),f=3===i&&3===c,[A,y]=(0,r.useState)({region:"mainland",exportAs:3===i?"feedContent":"landingPage",exportAsLynx:f||location.search.includes("exportAsLynx"),hyruleJson:3===i?s:void 0,removeSDK:!1}),[g,v]=(0,r.useState)((()=>f?w({},x):w(w({},x),a))),[h,b]=(0,r.useState)({}),[E,Z]=(0,r.useState)(!0);(0,u.Z)("ExportSettings",(e=>y((t=>w(w({},t),e))))),(0,r.useEffect)((()=>{if(!t)return;let n=!1;return Z(!0),m.dJ.post("project/syncToAdInit",{id:e,type:Number(new URLSearchParams(location.search).get("type")),region:JSON.stringify(A)}).then((e=>S(void 0,[e],(function*({data:{data:e}}){const t=yield C(e.key,g);n||(b(O(x,e)),b(O(g,t)),Z(!1))})))).catch((e=>{if(n)return;let t=3;const r=l.Z.error({title:"压缩初始化失败，请稍后重试",content:e.message||"未知失败原因，请稍后重试",okButtonProps:{disabled:!0},okText:"重试(3s)",onOk(){y((e=>w({},e)))}}),a=setInterval((()=>{t--,r.update({okText:t?`重试(${t}s)`:"重试",okButtonProps:{disabled:t>0}}),t<=0&&clearInterval(a)}),1e3)})),()=>{n=!0}}),[e,t,A]);const C=(t,r)=>S(void 0,null,(function*(){const a=Date.now(),l=yield j(e,t,n,r,A),o=Date.now();return P(w({},l),{duration:o-a})}));return P(w({oneValues:g,exportSettings:A,compressing:E},(0,r.useMemo)((()=>{const e=null==h?void 0:h[`${g.imageQuality}.${g.videoQuality}.${g.audioQuality}`];return e?(o.current=e,{result:e,outdated:!1,guessSize:e.afterSize}):{result:o.current,outdated:!0,guessSize:k(h,g)}}),[g,h])),{setValues:v,onCompress:()=>S(void 0,null,(function*(){try{Z(!0);const e=yield C(h["10.10.10"].key,g);return b(O(g,e)),e}catch(e){throw p.ZP.error(e.message||"压缩失败，请稍后重试"),e}finally{Z(!1)}}))})};const O=({imageQuality:e,videoQuality:t,audioQuality:n},r)=>a=>{console.info("Zip下载地址：",r.url);for(const[e,t]of Object.entries(r))if(e.toLowerCase().includes("preview")&&"string"==typeof t&&t.includes("index.html")){const n=new URL(t);n.searchParams.set("refer","scan"),n.searchParams.set("is_playable","1"),r[e]=n.href}return P(w({},a),{[`${e}.${t}.${n}`]:r})},k=(e,{imageQuality:t,videoQuality:n,audioQuality:r})=>{const a=[t,n,r];let l=[[10,10,10],{}],o=[[0,0,0],{}];for(const[t,n]of Object.entries(e)){const e=t.split(".").map(Number);e.every(((e,t)=>e>=a[t]))&&(!l[1].afterSize||n.afterSize<l[1].afterSize)&&(l=[e,n]),e.every(((e,t)=>e<=a[t]))&&(!o[1].afterSize||n.afterSize>o[1].afterSize)&&(o=[e,n])}let i=0,c=0;for(const[e,[t=0,n=0]]of(0,f.zip)(o[0],l[0]).entries()){if(t===n)continue;const r=["imageSize","videoSize","audioSize"][e],s=C(o[1][r]||0,l[1][r]||0,a[e],t,n);i+=s-(o[1][r]||0),c+=(l[1][r]||0)-s}return Math.floor(C(o[1].afterSize||0,l[1].afterSize||0,i,0,i+c))},C=(e,t,n,r,a)=>e+(t-e)*(n-r)/(a-r||1),j=(e,t,n,r,a)=>S(void 0,null,(function*(){const{data:{data:l}}=yield m.dJ.post("project/syncToAdCompress",w({id:e,key:t,exportOnly:n,region:JSON.stringify(a)},r));for(;;){const{data:{data:t}}=yield new Promise(((t,n)=>{setTimeout((()=>S(this,null,(function*(){try{t(yield m.dJ.get(`project/syncToAdCompressResult?id=${e}&taskId=${l.id}`))}catch(e){n(e)}}))),3e3)}));if(1===t.status)return t;if(2===t.status)throw new Error("压缩失败")}}));var I=n(56808),z=(e,t,n)=>new Promise(((r,a)=>{var l=e=>{try{i(n.next(e))}catch(e){a(e)}},o=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,o);i((n=n.apply(e,t)).next())}));const L=(e,t=1,n=100)=>z(void 0,null,(function*(){const{data:{data:{total:r,list:a}}}=yield I.dJ.post(`user/getCompanyAdvs?page=${t}&pageSize=${n}`,{companyId:e});return t*n>=r?a:a.concat(yield L(e,t+1,n))}));var N=n(2961),V=n(15361),D=n(98340),B=n(40985),F=n(42761),T=n(7910);var M=n(62732),R=n(22142),W=(0,r.memo)((({firstSceneSize:e,hasWarnings:t})=>{const[n,a]=(0,r.useState)(!0),l=((e=0)=>{const t=(0,F.v9)((({project:e})=>e)),[n,a]=(0,r.useState)([]);return(0,r.useEffect)((()=>{var e,n;(e=(0,B.qU)(t),n=function*(){const t=[],n=e.scenes.find((({type:e,editor:{loading:t}})=>"Scene"===e&&!t));n&&Object.entries(n.props).some((([e,{type:t,time:r}])=>"Controller"===t&&r<16&&"Video"===(0,B.qC)(n.nodes,Number(e),!0)[0].type))&&t.push((0,T.F3)("主场景“",{text:n.name},"”使用视频作为首帧可能导致开始互动率偏低，建议慎用"));for(const n of(0,d.checkDownloadOpacity)(e))(yield n)&&t.push(yield n);return(0,f.sumBy)(e.scenes,(({props:e})=>(0,f.sumBy)(Object.values(e),(({type:e})=>Number("Video"===e)))))>6&&t.push("作品中的视频总数建议不超过6个，可能导致卡顿等问题"),t.concat(e.scenes.reduce(((e,t)=>e.concat(Array.from((0,d.checkSceneWarnings)(t)))),[]).map((({message:e})=>e)))},new Promise(((e,t)=>{var r=e=>{try{l(n.next(e))}catch(e){t(e)}},a=e=>{try{l(n.throw(e))}catch(e){t(e)}},l=t=>t.done?e(t.value):Promise.resolve(t.value).then(r,a);l((n=n.apply(void 0,null)).next())}))).then(a)}),[t]),e>1572864?["首个主场景中的素材资源建议不超过1.5M。不要放置较大视频和大量序列帧，以免影响加载完成率",...n]:n})(e).map(((e,t)=>(0,T.F3)(`${t+1}. `,e)));return t.current=l.length,l.length?((0,B.r3)(B.GM.RiskAlert,{from:"同步中曝光"}),R.createElement(N.Z.Item,{label:"风险提示"},R.createElement("div",{style:{width:300,userSelect:"text"}},(n?l.slice(0,1):l).map(((e,t)=>R.createElement("div",{key:t},e)))),l.length>1&&R.createElement("div",{className:(0,M.iv)({button:{padding:0},"button+button":{marginLeft:16}})},n?R.createElement(o.Z,{type:"link",icon:R.createElement(s.Z,{component:V.Z}),onClick:()=>{a(!1)}},"展开全部"):R.createElement(o.Z,{type:"link",icon:R.createElement(s.Z,{component:D.Z}),onClick:()=>{a(!0)}},"收起全部")))):null})),U=n(8411);function q({firstSceneSize:e,playableError:t,QRCodeUrl:n,outdated:a,hasWarnings:l}){const o=(0,U.Y)(n,{width:132}),{sceneMode:i}=(0,d.useEditor)(0,"sceneMode");return r.createElement(N.Z,{colon:!1,labelAlign:"left",wrapperCol:{span:19},labelCol:{span:5},className:(0,M.iv)({maxHeight:350,overflow:"auto",paddingLeft:20,"::-webkit-scrollbar":{display:"none"}})},"Product"!==i&&r.createElement(W,{firstSceneSize:e,hasWarnings:l}),r.createElement(N.Z.Item,{label:"预览二维码"},r.createElement("div",{style:{paddingTop:6}},"请用「抖音」App扫码预览",r.createElement("div",{style:{color:"#999",fontSize:12,padding:"8px 0"}},"「抖音」请用21.6.0以上版本扫码"),r.createElement("div",{style:{width:132,height:132,position:"relative"}},r.createElement("img",{src:o,style:{opacity:a||t?.2:1}}),(a||t)&&r.createElement("div",{style:{justifyContent:"center",alignItems:"center",position:"absolute",textAlign:"center",overflow:"hidden",display:"flex",height:132,width:132,left:0,top:0}},a?r.createElement("div",null,"请点击“开始压缩”",r.createElement("br",null),"后查看最新预览"):t)))))}var G=n(26494),X=n(68961),J=n(10839),H=n(26840),K=n(80863),Q=n(76151);function Y({form:e,searching:t,setSearching:n,loading:a,options:l}){const[o,i]=(0,r.useState)([]),[c,s]=(0,r.useState)([]),[d,u]=(0,r.useState)(""),p=(0,r.useRef)({}),f=(0,G.Z)((t=>{Array.isArray(t)?(s(t),e.setFieldsValue({granted:t})):s((n=>n.includes(t)?n:(e.setFieldsValue({granted:n.concat(t)}),n.concat(t))))}));return(0,r.useEffect)((()=>{var e;const t=e=>{return t=this,null,n=function*(){if(!e)return e;if(void 0===p.current[e])try{const{data:{data:t}}=yield m.dJ.get("user/advExist",{params:{advId:e}});p.current[e]=t.advId===e}catch(t){console.error("Failed to check advId",e)}return e},new Promise(((e,r)=>{var a=e=>{try{o(n.next(e))}catch(e){r(e)}},l=e=>{try{o(n.throw(e))}catch(e){r(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,l);o((n=n.apply(t,null)).next())}));var t,n},r=d.split(/[ ,;，；]+/),a=null!=(e=r.pop())?e:"";n(!0),Promise.all([Promise.all(r.filter(Boolean).filter((e=>l.every((({id:t})=>e!==t)))).map(t)),t(a)]).then((([e,t])=>{var n;(n=t)&&p.current[n]?i([{id:n,name:""}]):i([]),(e=>{u((t=>{for(const n of e)t=t.replace(new RegExp(`${n}[ ,;，；]+`,"g"),""),f(n);return t}))})(e)})).finally((()=>{n(!1)}))}),[d,l,f,n]),r.createElement(N.Z,{form:e,layout:"vertical",initialValues:{granted:c},style:{minHeight:200}},r.createElement(N.Z.Item,{label:`广告主ID(${c.length}/20)`,name:"granted",rules:[{required:!0,message:"至少选择一个广告主ID！"},{validator(e,t,n){t.length>20?n("至多选择20个广告主ID！"):n()}}]},r.createElement(X.Z,{allowClear:!0,disabled:a,loading:a,virtual:!1,mode:"multiple",className:(0,M.iv)({width:"84% !important",".ant-select-selection-overflow":{minHeight:92,alignContent:"flex-start"},".ant-select-selection-placeholder":{top:4,transform:"none"}}),placeholder:"请输入广告主ID，批量输入时以分隔符间隔，支持，；和空格，不区分中英文输入法",notFoundContent:r.createElement(J.Z,{description:"没有找到相关广告主",image:J.Z.PRESENTED_IMAGE_SIMPLE}),searchValue:d,onSearch:e=>{for(const t of e.split(/[ ,;，；]+/).slice(0,-1))l.some((({id:e})=>t===e))&&(e=e.replace(new RegExp(`${t}[ ,;，；]+`,"g"),""),f(t));u(e)},onChange:e=>{f(e),u("")},filterOption:(e,{value:t})=>t.startsWith(e),tagRender:({label:e,value:t,closable:n,onClose:a})=>{const o=l.some((({id:e})=>t===e)),i=o||p.current[t];return r.createElement(H.Z,{title:i?void 0:"该ID不存在"},r.createElement(K.Z,{color:i?"default":"warning",closable:n,onClose:a},o?e:p.current[t]?`${t}-`:t))},dropdownRender:e=>t?r.createElement("div",{style:{textAlign:"center",padding:8}},r.createElement(Q.Z,{spinning:!0})):r.createElement("div",null,l.some((({id:e})=>e.startsWith(d)))&&!o.length&&r.createElement("div",{style:{display:"flex",justifyContent:"space-between",padding:"8px 12px"}},r.createElement("strong",null,"当前可推送账户"),r.createElement("small",null,"说明：以下为已绑定账户和已授权通过的账户")),e)},l.concat(o).map((({id:e,name:t})=>r.createElement(X.Z.Option,{key:e,value:e,disabled:c.length>=20&&!c.includes(e)},e,"-",t))))))}var $=n(62255),_=n(68373),ee=n(22142);function te({form:e,size:t,outdated:n,showZipName:r,initialValues:a,zipSize:l=3,loading:o,nextAction:i="下一步",onValuesChange:c,isVRVideo:s}){return ee.createElement(N.Z,{form:e,colon:!1,initialValues:a,wrapperCol:{span:19},labelCol:{span:5},onValuesChange:(e,t)=>{c(t)}},r&&ee.createElement(N.Z.Item,{label:"作品名称",name:"zipName",rules:[{required:!0,whitespace:!0,message:"请输入作品名称！"},{max:20,message:"作品名称不得超过20个字！"}]},ee.createElement($.Z,{placeholder:"请输入作品名称"})),ee.createElement(N.Z.Item,{label:"当前大小",className:(0,M.iv)({"> .ant-form-item-label":{display:"flex",alignItems:"center",justifyContent:"flex-end"}})},o?"正在计算包体大小...":n?"请点击“开始压缩”后查看当前设置下实际大小":ee.createElement("div",{style:{display:"flex",alignItems:"center"}},ee.createElement("div",{style:{paddingRight:12}},(e=>Math.max(e/1024/1024,.1).toFixed(1))(t),"M"),ee.createElement("div",{style:{color:"#999999",paddingLeft:12,borderLeft:"solid 1px #E0E0E0"}},t>1024*l*1024?`包体超过${l}M, 请确保推送广告主账号有${l}M以上素材投放权限`:`< ${l}M，可以进入${i}`))),[{label:"图片质量",name:"imageQuality"},{label:"音频质量",name:"audioQuality"},{label:"视频质量",name:"videoQuality"}].map((({label:e,name:t})=>ee.createElement(N.Z.Item,{label:e,name:t,key:t},ee.createElement(_.ZP.Group,{className:(0,M.iv)({display:"flex","& > label":{flex:"auto",textAlign:"center"}})},ee.createElement(_.ZP.Button,{value:10},"原大小"),ee.createElement(_.ZP.Button,{value:8,disabled:s},"高"),ee.createElement(_.ZP.Button,{value:6,disabled:s},"中"),ee.createElement(_.ZP.Button,{value:4,disabled:s},"低"))))))}var ne=n(39472),re=n(11018),ae=({value:e,onChange:t})=>r.createElement("div",{style:{display:"flex"}},r.createElement(le,{title:"APP应用",content:"推广您的线上APP",selected:1===e,icon:"data:image/png;base64,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",onClick:()=>{null==t||t(1)}}),r.createElement(le,{title:"电商店铺引流",content:"提升线上店铺的推广效果",selected:2===e,icon:"data:image/png;base64,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",onClick:()=>{null==t||t(2)}}));const le=({title:e,content:t,icon:n,selected:a,onClick:l})=>{const o=(0,M.iv)({display:"flex",alignItems:"center",borderRadius:4,border:"1px solid #EEEEEE",cursor:"pointer",padding:16,width:208,height:102,"&+&":{marginLeft:16},"&-selected":{borderColor:"#3955F6",".ant-form-item-has-error &":{borderColor:"#f65656"}}});return r.createElement("div",{onClick:l,className:(0,B.xG)({[o]:{selected:a}})},r.createElement("div",{style:{flex:"auto"}},r.createElement("h3",null,e),r.createElement("div",{style:{color:"#999999"}},t)),r.createElement("img",{src:n}))};var oe=Object.defineProperty,ie=Object.defineProperties,ce=Object.getOwnPropertyDescriptors,se=Object.getOwnPropertySymbols,de=Object.prototype.hasOwnProperty,ue=Object.prototype.propertyIsEnumerable,pe=(e,t,n)=>t in e?oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,me=(e,t)=>{for(var n in t||(t={}))de.call(t,n)&&pe(e,n,t[n]);if(se)for(var n of se(t))ue.call(t,n)&&pe(e,n,t[n]);return e},fe=(e,t)=>ie(e,ce(t)),Ae=(e,t,n)=>new Promise(((r,a)=>{var l=e=>{try{i(n.next(e))}catch(e){a(e)}},o=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,o);i((n=n.apply(e,t)).next())})),ye=e=>{const{getState:t}=(0,F.oR)(),[n,a]=(0,r.useState)(void 0),[l,i]=(0,r.useState)(!1);return{title:"选择转化类型",okDisabled:l||void 0===n,cancelDisabled:l,spinning:!1,element:r.createElement(N.Z,{form:e,layout:"vertical",initialValues:{convertType:void 0,activeUrl:""},style:{minHeight:360}},r.createElement(N.Z.Item,{label:"选择转化类型",name:"convertType",rules:[{required:!0,message:"请选择该素材的转化类型！"},{validator(e,n){return Ae(this,null,(function*(){1===n&&(yield(0,d.checkStateDownloadText)((0,B.qU)(t().project),"下载"))}))}}]},r.createElement(ae,{onChange:e=>{a(e)}})),1===n?r.createElement(N.Z.Item,{label:"App链接"},r.createElement(s.Z,{component:e=>r.createElement(re.Z,fe(me({},e),{theme:"filled",fill:"#3955F6"}))})," ","App链接请到广告投放平台上进行填写"):2===n?r.createElement(r.Fragment,null,r.createElement(N.Z.Item,{label:"店铺Web链接"},r.createElement(N.Z.Item,{noStyle:!0,name:"activeUrl",rules:[{required:!0,message:"请填写该素材的店铺Web链接！"}]},r.createElement($.Z,{style:{width:"60%"},placeholder:"请输入店铺Web链接",onChange:()=>{e.setFieldsValue({schemeUrl:""})}})),r.createElement(o.Z,{style:{width:"18%",marginLeft:16},loading:l,onClick:()=>{i(!0);const t=e.getFieldsValue();m.dJ.post("project/urlTransScheme",{url:t.activeUrl}).then((({data:e})=>e.data.scheme)).then((n=>{e.setFieldsValue(fe(me({},t),{schemeUrl:n}))})).catch((e=>{p.ZP.error(e.message)})).finally((()=>{i(!1)}))}},"生成店铺App链接")),r.createElement(N.Z.Item,{label:"店铺App链接",name:"schemeUrl",rules:[{required:!0,message:"请点击“生成店铺App链接”自动生成店铺App链接"}]},r.createElement($.Z,{disabled:!0,style:{width:"60%"},placeholder:"你可点击“生成店铺App链接”后自动生成"}))):null),mapValues(e){return Ae(this,arguments,(function*({convertType:e,activeUrl:t,schemeUrl:n}){return 1===e?{convertType:e}:{convertType:e,activeUrl:t,schemeUrl:n}}))}}},ge=n(70761),ve=n(69078),he=n(72299),be=n(74712),Ee=n(80926),we=n(51514),Pe=n(22142),Se=Object.defineProperty,xe=Object.defineProperties,Ze=Object.getOwnPropertyDescriptors,Oe=Object.getOwnPropertySymbols,ke=Object.prototype.hasOwnProperty,Ce=Object.prototype.propertyIsEnumerable,je=(e,t,n)=>t in e?Se(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Ie=()=>{const{getState:e}=(0,F.oR)(),{previewUrl:t,updatePreviewUrl:n}=(0,be.E)(e),[l,o]=(0,r.useState)(!1),s=(0,we.FJ)(),[p,m]=(0,r.useState)(0),[A,y]=(0,r.useState)(!0),[g,v]=(0,r.useState)([]);(0,r.useEffect)((()=>{n().then((()=>y(!1))),v((0,f.uniqBy)((0,d.checkDirectDownloadScript)((0,B.qU)(e().project)),"id"))}),[]);const{trigger:h}=(0,u.Z)("ExportSettings");(0,r.useEffect)((()=>{h({exportAsLynx:l})}),[l,h]);const b=g.some((({passed:e})=>e));return{title:"前置试玩校验",okDisabled:!b&&(0,T.cM)({release:!0})&&!s,cancelDisabled:!1,spinning:A,element:Pe.createElement("div",{className:(0,M.iv)({display:"flex"})},Pe.createElement("div",{className:(0,M.iv)({flex:"none"})},Pe.createElement(Ue,{title:"试玩区",Icon:c.Z}),Pe.createElement("div",{className:(0,M.iv)({display:"flex",alignItems:"center"})},Pe.createElement("div",{className:(0,M.iv)({padding:8,borderRadius:8,margin:"0 20px",boxShadow:"-4px 0px 16px rgba(0, 0, 0, 0.06), inset 1px 0px 4px rgba(0, 0, 0, 0.12)"})},!A&&Pe.createElement(ge.c,{mask12:!0,width:172,height:374,key:p,onReplay:()=>m((e=>e+1)),httpUrl:t+"&previewMode=true",onEventTracked:e=>{"playableEnd"===e.eventName&&(console.log(e,g),v((t=>t.map((t=>{return t.passed||t.id!==e.params.areaId?t:(n=((e,t)=>{for(var n in t||(t={}))ke.call(t,n)&&je(e,n,t[n]);if(Oe)for(var n of Oe(t))Ce.call(t,n)&&je(e,n,t[n]);return e})({},t),xe(n,Ze({passed:!0})));var n})))))}})),Pe.createElement("div",{className:(0,M.iv)({width:1,height:360,background:"#EBEBEB",margin:"0 36px 0 16px"})}))),Pe.createElement("div",{className:(0,M.iv)({flex:"auto"})},Pe.createElement(Ue,{title:"前置校验结果（必要步骤）",Icon:i.Z}),Pe.createElement("div",{className:(0,M.iv)({marginLeft:20})},Pe.createElement(Ee.Z.Text,{type:"secondary"},"• 试玩过程中是否能正常触发一次【调起下载组件】"),Pe.createElement("div",{className:(0,M.iv)({overflow:"auto",borderRadius:4,margin:"16px 0",padding:12,height:200,width:500})},g.map((({id:e,name:t,passed:n})=>{const r=n?"success":"secondary";return Pe.createElement("div",{key:e,className:(0,M.iv)({display:"flex",justifyContent:"space-between",lineHeight:"28px",columnGap:12,whiteSpace:"nowrap"})},Pe.createElement(Ee.Z.Text,{type:r,style:{overflow:"hidden",textOverflow:"ellipsis"}},t,"元素触发【调起下载组件】事件"),Pe.createElement(Ee.Z.Text,{type:r},n?"通过":"未玩到"))}))),Pe.createElement("div",null,b&&Pe.createElement(Ee.Z.Text,{type:"success",style:{marginRight:16}},Pe.createElement(ve.Z,null)," 前置校验通过"),Pe.createElement(a.Z,{checked:l,onChange:({target:{checked:e}})=>{o(e)}},"导出为Lynx"),Pe.createElement(H.Z,{title:"Lynx导出说明"},Pe.createElement(he.Z,{className:(0,M.iv)({cursor:"pointer"}),onClick:()=>{window.open("https://bytedance.feishu.cn/docx/YgUFdXkQJoJ6nPx8Xwbc6b4Vnwf")}})))))),mapValues(){return t=this,null,n=function*(){if(l){const{project:n}=e();for(const e of n.scenes.filter((e=>"Scene"===e.type)))if(Array.from(t(e.nodes,(function*(e){"Lottie"===e.type&&(yield e)}))).length)throw new Error("导出为Lynx暂不支持Lottie节点")}return{};function*t(e,n){for(const r of e)yield*n(r),r.nodes&&(yield*t(r.nodes,n))}},new Promise(((e,r)=>{var a=e=>{try{o(n.next(e))}catch(e){r(e)}},l=e=>{try{o(n.throw(e))}catch(e){r(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,l);o((n=n.apply(t,null)).next())}));var t,n}}},ze=n(22142),Le=Object.defineProperty,Ne=Object.getOwnPropertySymbols,Ve=Object.prototype.hasOwnProperty,De=Object.prototype.propertyIsEnumerable,Be=(e,t,n)=>t in e?Le(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,Fe=(e,t)=>{for(var n in t||(t={}))Ve.call(t,n)&&Be(e,n,t[n]);if(Ne)for(var n of Ne(t))De.call(t,n)&&Be(e,n,t[n]);return e},Te=(e,t,n)=>new Promise(((r,a)=>{var l=e=>{try{i(n.next(e))}catch(e){a(e)}},o=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,o);i((n=n.apply(e,t)).next())}));const Me=({onSaving:e,showZipName:t=!1,exportOnly:n=!1,title:o="压缩与真机效果预览",nextAction:s,headerTitle:u=(t?"名称与压缩设置":"压缩设置")})=>(p,m)=>{const f=(0,we.FJ)(),{getState:A,dispatch:y}=(0,F.oR)(),[g,v]=(0,r.useState)(!1),h=(0,r.useRef)(0),{id:b,name:E,settings:{compressOptions:w,typeOfPlay:P,category:S}}=A().project,{compressing:x,result:O,outdated:k,guessSize:C,oneValues:j,exportSettings:I,onCompress:z,setValues:L}=Z(b,m,n,w),N=0===P&&(0,T.cM)({release:!1}),[V,D]=(0,r.useState)(N),B=3===P&&3===S;return{result:O,title:o,okDisabled:x||g,cancelDisabled:x||g,spinTip:"素材包压缩中，请耐心等待...",spinning:x||g,footer:0===P&&((0,T.cM)({release:!1})||f)&&!I.exportAsLynx&&ze.createElement(a.Z,{checked:V,onChange:({target:{checked:e}})=>D(e)},"直接导出成URL(无zip包下载)"),element:ze.createElement("div",{className:(0,M.iv)({display:"flex","& label":{color:"#999999"}})},ze.createElement("div",{style:{flex:"1 1 0",paddingRight:48,borderRight:"solid 1px #E4E9ED"}},ze.createElement(Ue,{Icon:i.Z,message:"包体大小会影响加载效率，建议压缩",title:u,paddingLeft:16}),ze.createElement(te,{form:p,loading:x,showZipName:t,nextAction:s,initialValues:Fe({zipName:E},j),zipSize:3===P?6:3,size:(null==O?void 0:O.afterSize)||0,outdated:k,onValuesChange:e=>{L((t=>Fe(Fe({},t),e)))},isVRVideo:B}),ze.createElement(qe,{guessSize:C,onCompress:z})),ze.createElement("div",{style:{flex:"1 1 0",paddingLeft:28}},ze.createElement(Ue,{Icon:c.Z,title:"压缩效果",paddingLeft:20}),ze.createElement(q,{firstSceneSize:null==O?void 0:O.firstSceneSize,hasWarnings:h,playableError:null==O?void 0:O.playableError,QRCodeUrl:(null==O?void 0:O.feedPlayablePreviewUrl)||(null==O?void 0:O.previewUrl)||"",outdated:k}))),mapValues(t){return Te(this,null,(function*(){const r=()=>Te(this,null,(function*(){v(!0);try{const n=k||!O?yield z():O;if(n.playableError)throw new Error(n.playableError);if((0,T.cM)({release:!0})&&!f&&3===P&&n.afterSize>7340032)throw new Error(`当前包体过大，请压缩到7M以内再${null!=s?s:"下一步"}`);return y((0,d.setSettings)({compressOptions:t})),yield e(),{region:I.region,zipName:t.zipName,key:(null==n?void 0:n.key)||"",downloadUrl:n.playableUrl||n.url,exportUrl:V&&!I.exportAsLynx,QRCodeUrl:(null==O?void 0:O.feedPlayablePreviewUrl)||(null==O?void 0:O.previewUrl)||"",zipUrl:null==O?void 0:O.url,lynxUrl:null==n?void 0:n.lynxUrl}}finally{v(!1)}}));return h.current?new Promise(((e,t)=>{l.Z.confirm({title:"风险提示",content:`当前还有${h.current}个风险未处理，可能会影响投放效果，是否继续${n?"导出":"同步"}？`,cancelText:"继续",okText:"取消",onCancel(){e(r())},onOk(){t(new Error(`风险未处理，${n?"导出":"同步"}已取消`))}})})):r()}))}}},Re=e=>{const{loading:t,options:n}=(()=>{const[e,t]=(0,r.useState)([]),[n,a]=(0,r.useState)(!1);return(0,r.useEffect)((()=>{Promise.all([z(void 0,null,(function*(){const{data:{data:{advertiser:{company_id:e,id:t}}}}=yield I.dJ.get("user/getAdvInfoBySelfId");return L(e||t)})).catch((()=>[])),m.dJ.get("user/authorizedAdvList").then((({data:{data:{list:e}}})=>e.map((({advId:e,advName:t})=>({id:e,name:t}))))).catch((()=>[]))]).then((e=>{const n=(0,f.uniqBy)(e.flat(),"id");t(n),a(!1)}))}),[]),{loading:n,options:e}})(),[a,l]=(0,r.useState)(!1);return{title:"选择推送广告主",okDisabled:a,cancelDisabled:a,spinning:!1,element:ze.createElement(Y,{form:e,loading:t,options:n,searching:a,setSearching:l}),mapValues(e){return Te(this,null,(function*(){return{granted:e.granted,authed:n.map((({id:e})=>e))}}))}}};function We({onConfirm:e,onCancel:t,onSaving:n}){const{typeOfPlay:r}=(0,d.useProject)("settings");return ze.createElement(ne.Z,{title:"同步作品至广告投放平台（AD）",action:"同步",onCancel:t,onConfirm:t=>e(t),useStepHooks:[...3===r?[Ie]:[ye],Me({onSaving:n,showZipName:!0}),Re]})}const Ue=({title:e,Icon:t,message:n,paddingLeft:r=0})=>ze.createElement("div",{style:{display:"flex",alignItems:"center",padding:`0 0 24px ${r}px`}},ze.createElement("div",{style:{fontSize:16,paddingRight:12,fontWeight:500}},ze.createElement(s.Z,{component:t})," ",e),n&&ze.createElement("div",{style:{flex:"auto",color:"#999999",paddingLeft:12,borderLeft:"solid 1px #E0E0E0"}},n)),qe=({onCompress:e,guessSize:t})=>{return ze.createElement("div",{style:{display:"flex",justifyContent:"flex-end",alignItems:"center"}},ze.createElement("div",{style:{paddingRight:16}},"预估大小：",(n=t,Math.max(n/1024/1024,.1).toFixed(1)),"M"),ze.createElement(o.Z,{onClick:e},"开始压缩"));var n}},32356:function(e,t,n){n.d(t,{ZP:function(){return U},Q:function(){return q}});var r=n(22142),a=n(33058),l=n(48030),o=n(72299),i=n(19104),c=n(40985),s=n(4772),d=n(32078),u=n(61754),p=n(26840),m=n(36551),f=n(79761),A=n(54520),y=n(70072),g=n(57558),v=n(49934),h=n(27086),b=n(62732),E=n(7910),w=Object.defineProperty,P=Object.defineProperties,S=Object.getOwnPropertyDescriptors,x=Object.getOwnPropertySymbols,Z=Object.prototype.hasOwnProperty,O=Object.prototype.propertyIsEnumerable,k=(e,t,n)=>t in e?w(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,C=(e,t)=>{for(var n in t||(t={}))Z.call(t,n)&&k(e,n,t[n]);if(x)for(var n of x(t))O.call(t,n)&&k(e,n,t[n]);return e},j=(e,t)=>P(e,S(t));const I=e=>r.createElement(g.Z,j(C({},e),{theme:"filled"})),z=e=>r.createElement(v.Z,j(C({},e),{theme:"filled"}));function L({succeeded:e,results:t,onCancel:n}){const l=t.reduce(((e,{aadvids:t})=>e+t.length),0);return r.createElement(d.Z,{open:!0,width:600,footer:null,onCancel:n,closeIcon:r.createElement(a.Z,{component:h.Z}),title:e?r.createElement(r.Fragment,null,r.createElement(a.Z,{component:I,style:{color:"#FAAD15"}})," ",e,"个账号推送成功，",l,"个账号推送失败"):r.createElement(r.Fragment,null,r.createElement(a.Z,{component:z,style:{color:"#F45858"}})," ",l,"个账号全部推送失败")},r.createElement(A.Z,{bordered:!0,dataSource:t,pagination:!1},r.createElement(A.Z.Column,{key:"aadvids",title:"推送失败账号",dataIndex:"aadvids",render:e=>e.map((e=>r.createElement("div",{key:e},e)))}),r.createElement(A.Z.Column,{key:"message",title:"失败原因",dataIndex:"message",width:"25%"}),r.createElement(A.Z.Column,{key:"action",title:"操作",dataIndex:"action",render:N})))}const N=(e,{grantUrl:t})=>t?r.createElement(r.Fragment,null,r.createElement("div",null,e),r.createElement("div",{className:(0,b.iv)({background:"#F8F9FA",wordBreak:"break-all",padding:"8px 12px",color:"#999999",button:{width:"100%"}})},t),r.createElement(y.Z,{type:"primary",style:{width:"100%"},onClick:()=>(0,E.zp)(t,{tip:!0})},"复制链接并分享给广告主")):e;var V=n(98466),D=Object.defineProperty,B=Object.getOwnPropertySymbols,F=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable,M=(e,t,n)=>t in e?D(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,R=(e,t)=>{for(var n in t||(t={}))F.call(t,n)&&M(e,n,t[n]);if(B)for(var n of B(t))T.call(t,n)&&M(e,n,t[n]);return e},W=(e,t,n)=>new Promise(((r,a)=>{var l=e=>{try{i(n.next(e))}catch(e){a(e)}},o=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,o);i((n=n.apply(e,t)).next())})),U=(0,r.memo)((({disabled:e,onSaving:t,getState:n})=>{const[A,y]=(0,r.useState)(0),[g,v]=(0,r.useState)(!1),[h,b]=(0,r.useState)([]),{typeOfPlay:E}=(0,i.useProject)("settings"),{showImDialog:w}=(0,i.useImbot)();return r.createElement(r.Fragment,null,r.createElement(m.Z,{icon:r.createElement(a.Z,{component:s.Z}),disabled:e,onClick:()=>W(void 0,null,(function*(){(0,c.r3)(c.GM.OperationButton,{type:"同步"});try{if(yield t("同步"),3!==E)return v(!0);const e=(0,i.checkPlayableAreaAll)(n().project);if(!e)return v(!0);d.Z.confirm({autoFocusButton:null,title:"警示",icon:r.createElement(l.Z,null),content:`${e}，可能会影响互动效果，建议确认后再同步`,cancelText:"去检查",okText:"直接同步",onCancel:console.log,onOk:()=>v(!0)})}catch(e){u.ZP.error(e.message)}}))},"同步"," ",r.createElement(p.Z,{arrowPointAtCenter:!0,placement:"bottomRight",title:"将当前作品打包并同步至AD平台（无需导出再上传），审核、配置投放等操作请在AD平台完成。"},r.createElement(o.Z,{onClick:e=>{e.preventDefault(),w("同步")}}))),g&&r.createElement(f.ZP,{onCancel:()=>v(!1),onSaving:t,onConfirm:e=>W(void 0,null,(function*(){const t=Date.now(),{project:a}=n(),{succeeded:l,results:o,playableUrls:i}=yield q(a.id,R(R({},e),(e=>{const t=(0,c.dU)(e.scenes),n=Math.round(Math.min(0,Math.min(...Object.values(t.props).filter((({type:e})=>"Script"===e)).map((({time:e=0})=>e))))/1e3),r=Object.values(t.props).some((({type:e})=>"Button"===e)),a=(0,c.Lu)(e,t).scenes.reduce(((e,{props:t})=>{for(const{type:n,url:r}of Object.values(t))if("Animation"===n&&"string"==typeof r){const t=new URLSearchParams(r.slice(r.indexOf("?"))).get("mid");t&&e.add(t)}return e}),new Set);return{firstInteractionTime:n,downloadBtnAllShow:r,componentIds:Array.from(a)}})(a))),s=+((Date.now()-t)/1e3).toFixed(1);(0,c.r3)(c.GM.SyncLoadingTime,{duration:s}),(0,c.r3)(c.GM.ProductStatus,{type:1}),v(!1),i.length?d.Z.info({width:600,title:`成功将素材推送给${l}个广告主`,content:i.map(((e,t)=>r.createElement("div",{key:t,style:{userSelect:"text"}},e)))}):o.length?(y(l),b(o)):u.ZP.success(`成功将素材推送给${l}个广告主`)}))}),h.length>0&&r.createElement(L,{succeeded:A,results:h,onCancel:()=>{b([])}}))}));const q=(e,t)=>W(void 0,null,(function*(){var n=t,{granted:r,key:a,zipName:l,authed:o}=n,i=((e,t)=>{var n={};for(var r in e)F.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&B)for(var r of B(e))t.indexOf(r)<0&&T.call(e,r)&&(n[r]=e[r]);return n})(n,["granted","key","zipName","authed"]);const{data:{data:{unExistAdvIds:c,unAuthAdvIds:s,failedAdvIds:d,authToken:u}}}=yield V.dJ.post("user/advListAuth",{advIds:r.filter((e=>!o.includes(e)))}),p=r.filter((e=>[s,c,d].every((t=>!t.includes(e))))),m=[];let f=0;const A=[{aadvids:c,message:"该ID不存在",action:"请核查后重新推送"},{aadvids:d,message:"网络或其他原因",action:"请核查后重新推送"},{aadvids:s,message:"未获得广告主的推送授权",action:"请将以下链接发给对应的广告主申请推送权限",grantUrl:`https://cc.oceanengine.com/push/adv-auth?token=${u}&from=rubbex`}].filter((({aadvids:e})=>e.length));if(p.length){const{data:{data:{taskList:t}}}=yield V.dJ.post("project/syncToAdUpload",R({id:e,zipName:l,key:a,granted:p},i)),n=e;yield Promise.all(t.map((e=>W(this,[e],(function*({id:e,advId:t}){for(;;){const{data:{data:{status:r,message:a,playableUrl:l}}}=yield new Promise(((r,a)=>{setTimeout((()=>W(this,null,(function*(){try{r(yield V.dJ.get(`project/syncToAdUploadResult?taskId=${e}&advId=${t}&projectId=${n}`))}catch(e){a(e)}}))),3e3)}));if(1===r){const e=A.find((e=>e.message===a));return e?e.aadvids.push(t):A.push({aadvids:[t],message:a,action:"请核查后重新推送"})}if(r)return m.push(l),f++}})))))}return{playableUrls:m,succeeded:f,results:A}}))},29352:function(e,t,n){n.d(t,{M:function(){return Vn.Z},Z:function(){return Dn}});var r=n(22142),a=n(42761),l=n(33058),o=n(28471),i=n(43465),c=n(19104),s=n.p+"2bcfa7f6148e78fa643bea1bf4111921.svg",d=n(36551),u=n(12570),p=n(86694);function m({disabled:e}){const{canUndo:t,onUndo:n}=(0,c.useOnUndo)(),{redoSteps:a,onRedo:l}=(0,c.useOnRedo)();return r.createElement(r.Fragment,null,r.createElement(d.Z,{icon:r.createElement(u.Z,null),disabled:e||!t,onClick:n},"撤回"),r.createElement(d.Z,{disabled:e||0===a,icon:r.createElement(p.Z,null),onClick:l},"重做"))}var f=n(78296),A=n(50509),y=n(34394),g=n(85349),v=n(54588),h=n(40985),b=(0,r.memo)((()=>{const{flags:e,items:t,setFlags:n}=(0,g.OC)(),a=(0,g.ND)({flagBit:4,title:"打开FPS面板"});return(0,r.useEffect)((()=>{let e;const t=()=>{Laya&&Laya.stage?a?Laya.Stat.show():Laya.Stat.hide():e=setTimeout(t,10)};return t(),()=>{e&&clearTimeout(e)}}),[a]),1&e&&t.length?r.createElement(f.Z,{overlay:r.createElement(A.Z,null,t.sort((({flagBit:e},{flagBit:t})=>e-t)).map((t=>r.createElement(A.Z.Item,{key:t.flagBit},r.createElement(y.Z,{checked:Boolean(e&t.flagBit),onChange:({target:{checked:r}})=>{let a=e|t.flagBit;r||(a-=t.flagBit),n(a)}},t.title))))),placement:"bottomLeft"},r.createElement(d.Z,{icon:r.createElement(l.Z,{component:v.Z}),onClick:()=>{(0,h.r3)(h.GM.OperationButton,{type:"同步"})}},"调试")):null})),E=n(84075),w=n(92481),P=n(74712),S=n(51514),x=n(61754),Z=n(26840),O=n(67271),k=n(72299),C=n(56808),j=(e,t,n)=>new Promise(((r,a)=>{var l=e=>{try{i(n.next(e))}catch(e){a(e)}},o=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,o);i((n=n.apply(e,t)).next())})),I=n(2961),z=n(62255),L=n(73760),N=n(16969),V=n(70072),D=n(26995),B=n(64256),F=n(5238),T=n(60439),M=n(98466),R=n(62732),W=Object.defineProperty,U=Object.defineProperties,q=Object.getOwnPropertyDescriptors,G=Object.getOwnPropertySymbols,X=Object.prototype.hasOwnProperty,J=Object.prototype.propertyIsEnumerable,H=(e,t,n)=>t in e?W(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,K=(e,t)=>{for(var n in t||(t={}))X.call(t,n)&&H(e,n,t[n]);if(G)for(var n of G(t))J.call(t,n)&&H(e,n,t[n]);return e},Q=(e,t,n)=>new Promise(((r,a)=>{var l=e=>{try{i(n.next(e))}catch(e){a(e)}},o=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,o);i((n=n.apply(e,t)).next())})),Y=({value:e,onChange:t})=>{const[n,a]=(0,r.useState)(!1),o=(0,T.QO)(),i={accept:"image/*",action:"/api/upload/file",showUploadList:!1,headers:M.Dr,onChange({file:e}){"done"===e.status?t(e.response.data.previewUrl):"error"===e.status&&x.ZP.error(`${e.name}上传失败`)}};return r.createElement("div",{style:{display:"flex"}},r.createElement(N.Z.Dragger,(c=K({},i),s={style:e?{background:`url(${e||""})`}:void 0,className:(0,R.iv)({"&.ant-upload.ant-upload-drag":{width:100,height:144,backgroundSize:"contain !important",backgroundRepeat:"no-repeat !important",backgroundPosition:"center !important","&>*":{padding:0}}})},U(c,q(s))),!e&&r.createElement("div",{style:{height:"100%",display:"flex",flexDirection:"column",justifyContent:"center"}},r.createElement("p",{className:"ant-upload-hint"},r.createElement(l.Z,{component:D.Z,style:{fontSize:"1.38em"}}),r.createElement("br",null),"上传封面"))),r.createElement("div",{style:{display:"flex",flexDirection:"column"}},Boolean(e)&&r.createElement(N.Z,K({},i),r.createElement(V.Z,{type:"link",icon:r.createElement(l.Z,{component:B.Z})},"替换")),r.createElement(V.Z,{type:"link",loading:n,icon:r.createElement(l.Z,{component:F.Z}),onClick:()=>Q(void 0,null,(function*(){var e;a(!0);try{if(!(null==(e=o())?void 0:e.then((e=>Q(this,null,(function*(){const{previewUrl:n}=yield(0,M.D5)(e,"viewpoint");return t(n),!0}))))))throw new Error}catch(e){x.ZP.error("同步画板当前视图失败")}finally{a(!1)}}))},"同步画板当前视图")));var c,s};function $({form:e,getState:t}){const{name:n,description:a="",editor:{cover:l=""}}=t().project,o={name:n,cover:l,description:a},[i,c]=(0,r.useState)({validateStatus:"success",errorMsg:""}),s=(0,r.useRef)(null),d=(0,r.useRef)(!1);return(0,r.useEffect)((()=>{var e;const t=null==(e=s.current)?void 0:e.resizableTextArea,n=()=>{d.current=!0},r=()=>{d.current=!1};return!(0,L.isNil)(t)&&t.textArea&&(t.textArea.addEventListener("compositionstart",n),t.textArea.addEventListener("compositionend",r)),()=>{!(0,L.isNil)(t)&&t.textArea&&(t.textArea.removeEventListener("compositionstart",n),t.textArea.removeEventListener("compositionend",r))}}),[]),r.createElement(I.Z,{form:e,wrapperCol:{span:12},labelCol:{span:2},initialValues:o},r.createElement(I.Z.Item,{label:"版本名称",name:"name",rules:[{required:!0,whitespace:!0,message:"请输入版本名称！"},{max:20,message:"版本名称不得超过20个字！"}]},r.createElement(z.Z.TextArea,{placeholder:"请输入版本名称",rows:1,showCount:!0,maxLength:20,autoSize:!0})),r.createElement(I.Z.Item,{name:"cover",label:"版本封面",rules:[{required:!0,message:"请上传版本封面！"}]},r.createElement(Y,null)),r.createElement(I.Z.Item,{label:"版本描述",name:"description",validateStatus:i.validateStatus,help:i.errorMsg,rules:[{whitespace:!0,message:"版本描述不能为空格！"},{max:128,message:"版本描述不得超过128个字！"}]},r.createElement(z.Z.TextArea,{ref:s,showCount:!0,rows:4,maxLength:120,placeholder:"请输入版本描述",onChange:e=>{const t=e.currentTarget.value;setTimeout((()=>{(0,L.isNil)(t)||d.current||(t.length>128?c({validateStatus:"error",errorMsg:"版本描述不得超过128个字！"}):c({validateStatus:"success",errorMsg:""}))}))}})))}var _=n(79761),ee=n(39472),te=Object.defineProperty,ne=Object.getOwnPropertySymbols,re=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable,le=(e,t,n)=>t in e?te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,oe=(e,t,n)=>new Promise(((r,a)=>{var l=e=>{try{i(n.next(e))}catch(e){a(e)}},o=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,o);i((n=n.apply(e,t)).next())}));const ie=e=>t=>({title:"录入版本信息",okDisabled:!1,cancelDisabled:!1,spinning:!1,element:r.createElement($,{form:t,getState:e}),mapValues(e){return oe(this,null,(function*(){return e}))}});function ce({skinning:e,onCancel:t,getState:n,onSaving:a}){const{id:l}=n().project;return r.createElement(ee.Z,{action:"送审",title:"模板送审",onCancel:t,onConfirm:n=>oe(this,null,(function*(){yield a();const r=((e,t)=>{for(var n in t||(t={}))re.call(t,n)&&le(e,n,t[n]);if(ne)for(var n of ne(t))ae.call(t,n)&&le(e,n,t[n]);return e})({id:l,type:Number(new URLSearchParams(location.search).get("type")),pid:Number(location.pathname.split("/").pop())},n);var o;e?yield(o=r,j(void 0,null,(function*(){const{data:e}=yield C.dJ.post("template/pushSkin",o);return e.data}))):yield(e=>j(void 0,null,(function*(){const{data:t}=yield C.dJ.post("template/push",e);return t.data})))(r),x.ZP.success("送审成功"),t()})),useStepHooks:[(0,_.Wq)({onSaving:a,title:"压缩设置",headerTitle:"压缩设置"}),ie(n)]})}function se({disabled:e,skinning:t,getState:n,onSaving:a}){const[o,i]=(0,r.useState)(!1);return r.createElement(r.Fragment,null,r.createElement(d.Z,{icon:r.createElement(l.Z,{component:O.Z}),disabled:e,onClick:()=>{return e=this,null,n=function*(){(0,h.r3)(h.GM.OperationButton,{type:t?"皮肤送审 ":"送审 "});try{yield a("送审"),i(!0)}catch(e){x.ZP.error(e.message)}},new Promise(((t,r)=>{var a=e=>{try{o(n.next(e))}catch(e){r(e)}},l=e=>{try{o(n.throw(e))}catch(e){r(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(a,l);o((n=n.apply(e,null)).next())}));var e,n}},t?"皮肤送审 ":"送审 ",r.createElement(Z.Z,{arrowPointAtCenter:!0,placement:"bottomRight",title:t?"皮肤送审后将被推送至Rubeex审核方，审核通过后将上架到对应模板皮肤列表内。":"模板送审后将被推送到Rubeex的审核方，待审核通过后，客户即可使用该模板来创建作品。"},r.createElement(k.Z,null))),o&&r.createElement(ce,{skinning:t,getState:n,onSaving:a,onCancel:()=>i(!1)}))}var de=n(30191),ue=n(27086),pe=n(32078),me=n(76151),fe=n(80926),Ae=n(14270),ye=n(10268),ge=n(70043),ve=n(63150),he=n(7910),be=n(23247),Ee=n.n(be),we=n(34450),Pe=n.n(we),Se=n(46927),xe=n(8411),Ze=n(22142),Oe=Object.defineProperty,ke=Object.getOwnPropertySymbols,Ce=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable,Ie=(e,t,n)=>t in e?Oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ze=(e,t)=>{for(var n in t||(t={}))Ce.call(t,n)&&Ie(e,n,t[n]);if(ke)for(var n of ke(t))je.call(t,n)&&Ie(e,n,t[n]);return e};const Le=({histories:e})=>{const[t,n]=(0,r.useState)(-1);return Ze.createElement(Se.Z,{title:"导出历史",size:"small"},1===e.length?Ze.createElement(Ne,ze({},e[0])):Ze.createElement("div",{style:{display:"grid",gridTemplate:"auto / repeat(2,1fr)",gap:"8px 16px"}},e.map(((e,r)=>Ze.createElement("div",{key:r,onMouseEnter:()=>n(r),onMouseLeave:()=>n(-1),style:{opacity:t>-1&&r!==t?.25:1,transition:".3s"}},Ze.createElement(Ne,ze({},e)))))))},Ne=({content:e,createTime:t,QRCodeUrl:n,zipUrl:r})=>{const a=(0,xe.Y)(n,{width:132});return Ze.createElement("div",{style:{display:"grid",textAlign:"center"}},Ze.createElement("img",{src:a,alt:"预览二维码"}),r&&Ze.createElement(fe.Z.Link,{onClick:()=>{(0,h.Zk)(r)}},"下载Zip包"),e&&Ze.createElement(fe.Z.Link,{onClick:()=>(0,he.zp)(e,{tip:!0})},"复制导出URL"),Pe()(t).format("MM-DD HH:mm:ss"))};var Ve=Object.defineProperty,De=Object.defineProperties,Be=Object.getOwnPropertyDescriptors,Fe=Object.getOwnPropertySymbols,Te=Object.prototype.hasOwnProperty,Me=Object.prototype.propertyIsEnumerable,Re=(e,t,n)=>t in e?Ve(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,We=(e,t)=>{for(var n in t||(t={}))Te.call(t,n)&&Re(e,n,t[n]);if(Fe)for(var n of Fe(t))Me.call(t,n)&&Re(e,n,t[n]);return e};const Ue="editor.export.history",qe=e=>Array.isArray(e)?e:[],Ge=()=>{var e;return(0,he.cM)({release:!1})?qe((0,he.Mo)(null!=(e=localStorage.getItem(Ue))?e:"{}")[c.default.getState().project.id]).slice(0,6):[]},Xe=e=>{var t,n,r;if((0,he.cM)({release:!1})){const a=(0,he.Mo)(null!=(t=localStorage.getItem(Ue))?t:"{}"),l=c.default.getState().project.id;a[l]=[(n=We({},e),r={createTime:Date.now()},De(n,Be(r)))].concat(qe(a[l])).slice(0,6),localStorage.setItem(Ue,JSON.stringify(a))}};var Je=n(22142),He=Object.defineProperty,Ke=Object.getOwnPropertySymbols,Qe=Object.prototype.hasOwnProperty,Ye=Object.prototype.propertyIsEnumerable,$e=(e,t,n)=>t in e?He(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;const _e=({children:e})=>{const[t,n]=(0,r.useState)(Ge);return Je.createElement(f.Z,{onOpenChange:e=>{e&&n(Ge)},overlay:t.length>0?Je.createElement(Le,{histories:t}):Je.createElement("div",null),children:e})},et=({onOk:e,content:t,exportHistoryData:n})=>pe.Z.success({content:t,title:"导出成功",style:{userSelect:"text"},okText:"复制并关闭",onOk(){(0,he.zp)(t,{tip:!0}),n&&Xe(((e,t)=>{for(var n in t||(t={}))Qe.call(t,n)&&$e(e,n,t[n]);if(Ke)for(var n of Ke(t))Ye.call(t,n)&&$e(e,n,t[n]);return e})({content:t},n)),null==e||e()}});var tt=n(71092),nt=n(68373),rt=n(5635),at="data:image/png;base64,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",lt="data:image/png;base64,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",ot=n(22142);const it=({value:e,onChange:t})=>ot.createElement("div",{style:{display:"flex"}},ot.createElement(st,{title:"中国区",content:"用于投放中国区",selected:"mainland"===e,icon:at,onClick:()=>{null==t||t("mainland")}}),ot.createElement(st,{title:"非中国区",content:"用于投放非中国区",selected:"overseas"===e,icon:lt,onClick:()=>{null==t||t("overseas")}})),ct=({value:e,onChange:t})=>ot.createElement("div",{style:{display:"flex"}},ot.createElement(st,{title:"普通互动",content:"用于落地页",selected:"landingPage"===e,icon:at,onClick:()=>{null==t||t("landingPage")}}),ot.createElement(st,{title:"直出互动",content:"用于信息流",selected:"feedContent"===e,icon:lt,onClick:()=>{null==t||t("feedContent")}})),st=({title:e,content:t,icon:n,selected:r,onClick:a})=>{const{token:l}=rt.Z.useToken(),o=(0,R.iv)({display:"flex",alignItems:"center",borderRadius:4,border:"1px solid #EEEEEE",cursor:"pointer",padding:16,width:208,height:102,"&+&":{marginLeft:16},"&-selected":{borderColor:"#3955F6",".ant-form-item-has-error &":{borderColor:"#f65656"}}});return ot.createElement("div",{onClick:a,className:(0,h.xG)({[o]:{selected:r}})},ot.createElement("div",{style:{flex:"auto"}},ot.createElement("div",{className:(0,R.iv)({marginBottom:"0.5em",color:l.colorText,fontWeight:500})},e),ot.createElement("div",{style:{color:"#999999"}},t)),ot.createElement("img",{src:n}))};var dt=n(22142),ut=Object.defineProperty,pt=Object.getOwnPropertySymbols,mt=Object.prototype.hasOwnProperty,ft=Object.prototype.propertyIsEnumerable,At=(e,t,n)=>t in e?ut(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,yt=(e,t)=>{for(var n in t||(t={}))mt.call(t,n)&&At(e,n,t[n]);if(pt)for(var n of pt(t))ft.call(t,n)&&At(e,n,t[n]);return e},gt=e=>{const{trigger:t}=(0,tt.Z)("ExportSettings"),n=(0,c.useSettings)("typeOfPlay"),[a,l]=(0,r.useState)((()=>{const e={region:"mainland",exportAs:"landingPage",thumbnail:!0,playable_orientation:1,exportAsLynx:!1};try{return yt(yt({},e),JSON.parse(sessionStorage.getItem("exportOptions")))}catch(t){return e}}));return{title:"选择导出设置",okDisabled:!1,cancelDisabled:!1,spinning:!1,element:dt.createElement(I.Z,{form:e,layout:"vertical",initialValues:a},dt.createElement("div",{style:{display:"flex",flexWrap:"wrap",columnGap:24}},dt.createElement(I.Z.Item,{label:"选择投放区域",name:"region"},dt.createElement(it,null)),dt.createElement(I.Z.Item,{label:"选择投放类型",name:"exportAs"},dt.createElement(ct,null))),dt.createElement("div",{className:(0,R.iv)({display:"flex",alignItems:"flex-end",columnGap:24,"> div":{marginBottom:0}})},dt.createElement(I.Z.Item,{label:"横竖屏设置",name:"playable_orientation"},dt.createElement(nt.ZP.Group,{optionType:"button",options:[{label:"横屏",value:2},{label:"竖屏",value:1},{label:"横竖屏",value:0}]})),dt.createElement(I.Z.Item,{name:"thumbnail",valuePropName:"checked"},dt.createElement(y.Z,null,"使用缩略图加快首屏渲染")),0===n&&dt.createElement(I.Z.Item,{name:"removeSDK",valuePropName:"checked"},dt.createElement(y.Z,null,"导出为H5")),0!==n&&dt.createElement(I.Z.Item,{name:"exportAsLynx",valuePropName:"checked"},dt.createElement(y.Z,null,"导出为Lynx格式")))),mapValues(e){return n=this,null,r=function*(){return l(e),sessionStorage.setItem("exportOptions",JSON.stringify(e)),t(e),{removeSDK:e.removeSDK}},new Promise(((e,t)=>{var a=e=>{try{o(r.next(e))}catch(e){t(e)}},l=e=>{try{o(r.throw(e))}catch(e){t(e)}},o=t=>t.done?e(t.value):Promise.resolve(t.value).then(a,l);o((r=r.apply(n,null)).next())}));var n,r}}},vt=n(14766),ht=n.n(vt),bt=n(22142),Et=(e,t,n)=>new Promise(((r,a)=>{var l=e=>{try{i(n.next(e))}catch(e){a(e)}},o=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,o);i((n=n.apply(e,t)).next())})),wt=({onCancel:e,onSaving:t})=>{const{getState:n}=(0,a.oR)(),r=(0,S.FJ)();return bt.createElement(ee.Z,{title:"导出项目",action:"导出",onCancel:e,onConfirm:t=>Et(void 0,[t],(function*({downloadUrl:t,exportUrl:r,QRCodeUrl:a,region:l,zipUrl:o,removeSDK:i}){var c,s;try{const d=2===n().project.settings.typeOfPlay,u=n().project.id;if(r)d?yield(s=t,Et(void 0,null,(function*(){const e=s.replace(".zip","/"),{data:{pgc:t,res:n}}=yield Ee().get(`${e}light_data.json`),r={entry:`${e}riko.js`,resources:`${e}resources.json`,config:{basePath:e,pgc:t,res:n}};(0,h.Zk)(`data:application/json,${encodeURI(JSON.stringify({data:r},void 0,2))}`)}))):i?yield function(e){return Et(this,null,(function*(){const{data:t}=yield fetch("/api/faas/uploadZip",{method:"Post",headers:{"Content-Type":"application/json"},body:JSON.stringify({zipUrl:e})}).then((e=>e.json()));t&&et({content:t})}))}(t):yield Pt({zipUrl:t,region:l},u,{QRCodeUrl:a,zipUrl:o});else{if(/\.zip$/.test(t)){if(d){const e=yield fetch(t).then((e=>e.arrayBuffer())),n=yield null==(c=(yield ht().loadAsync(e)).file("./light_data.json"))?void 0:c.async("string");pe.Z.success({title:"导出成功",content:"已成功复制轻互动配置到剪切板，点击确定按钮跳转到轻互动预览界面",okText:"确定",onOk(){(0,he.zp)(n,{onCopySuccess:()=>{window.open(["https://light-play-boe","bytedance","net/"].join("."),"休闲互动")}})}})}(0,h.Zk)(t),Xe({QRCodeUrl:a,zipUrl:o})}else et({content:t,exportHistoryData:{QRCodeUrl:a,zipUrl:o}});const e=n().project.id;yield M.dJ.post(`disclosure/projectDuration/${e}/updateSyncDateList`,{syncDate:Pe()().format("YYYY-MM-DD HH:mm:ss")})}e()}catch(e){x.ZP.error(e.message)}})),useStepHooks:(0,he.cM)({release:!1})||r?[gt,(0,_.Wq)({onSaving:t,showZipName:!1,exportOnly:!0})]:[(0,_.Wq)({onSaving:t,showZipName:!1,exportOnly:!0})]})};const Pt=(e,t,n)=>Et(void 0,null,(function*(){const{data:{data:{id:r}}}=yield M.dJ.post("project/uploadRubeexPlayable",e);for(;;){const{data:{data:a}}=yield new Promise(((n,a)=>setTimeout((()=>Et(this,null,(function*(){try{n(yield M.dJ.get("project/uploadRubeexPlayableResult",{params:{id:r,projectId:t,region:e.region}}))}catch(e){a(e)}}))),300)));if(2===a.status&&a.url)return new Promise((e=>et({content:a.url,onOk:e,exportHistoryData:n})))}}));var St=n(73073),xt=(e,t,n)=>new Promise(((r,a)=>{var l=e=>{try{i(n.next(e))}catch(e){a(e)}},o=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,o);i((n=n.apply(e,t)).next())}));function Zt({disabled:e,onSaving:t}){const[n,o]=(0,r.useState)(!1),[i,c]=(0,r.useState)(!1),{getState:s}=(0,a.oR)();return r.createElement(r.Fragment,null,r.createElement(_e,null,r.createElement(d.Z,{icon:r.createElement(l.Z,{component:de.Z}),disabled:e,onClick:()=>xt(this,null,(function*(){(0,h.r3)(h.GM.OperationButton,{type:"导出"});try{yield t("导出");const{settings:e}=s().project;4!==e.typeOfPlay?o(!0):c(!0)}catch(e){console.error(e),x.ZP.error(e.message)}}))},"导出")),n&&r.createElement(wt,{onSaving:t,onCancel:()=>o(!1)}),i&&r.createElement(Ot,{onOk:()=>xt(this,null,(function*(){try{const{id:e}=s().project,{data:{data:t}}=yield M.dJ.post("project/syncToAdInit",{id:e,type:Number(new URLSearchParams(location.search).get("type")),region:JSON.stringify({})}),{data:{data:n}}=yield M.dJ.post("project/syncToAdCompress",{id:e,key:t.key,exportOnly:!0,region:JSON.stringify({}),imageQuality:8,videoQuality:8,audioQuality:8});for(;;){const{data:{data:t}}=yield new Promise(((t,r)=>{setTimeout((()=>xt(this,null,(function*(){try{t(yield M.dJ.get(`project/syncToAdCompressResult?id=${e}&taskId=${n.id}`))}catch(e){r(e)}}))),3e3)}));if(1===t.status){(0,h.Zk)(t.url);break}if(2===t.status)throw new Error("压缩失败")}}catch(e){x.ZP.error(e.message)}})),onCancel:()=>c(!1),onSaving:t}))}function Ot({onOk:e,onCancel:t,onSaving:n}){const{getState:o,dispatch:i}=(0,a.oR)(),s=o().project.id,[d,u]=(0,r.useState)(!1),[p,m]=(0,r.useState)(!1),f=(0,c.useSettings)("fallbackVideo"),A=(0,r.useRef)(null),[y,g]=(0,r.useState)(!1);(0,r.useEffect)((()=>{if(A.current){const e=A.current;y?(e.currentTime=0,e.play()):e.pause()}}),[y]);const v=y?Ae.Z:ye.Z;return r.createElement(pe.Z,{open:!0,width:318,title:"兜底视频上传（可选）",closeIcon:r.createElement(l.Z,{component:ue.Z}),okText:"导出",cancelText:"取消",okButtonProps:{loading:p},onCancel:t,onOk:()=>xt(this,null,(function*(){m(!0);try{yield n("导出"),yield e()}finally{m(!1)}}))},r.createElement(St.S2,{category:"NativeVideo",className:(0,R.iv)({"& .ant-upload":{padding:"0 !important"},cursor:"pointer"}),projectId:s,uploading:d,setUploading:u,onAddResourceEntry:e=>{A.current&&A.current.pause(),i((0,c.setSettings)({fallbackVideo:e.url}))}},r.createElement(me.Z,{spinning:d},f?r.createElement("div",{className:(0,R.iv)({width:270,height:480,position:"relative"})},r.createElement("video",{ref:A,src:f,className:(0,R.iv)({width:270,height:480,objectFit:"contain",display:"block",background:"#eee"})}),r.createElement(v,{className:(0,R.iv)({position:"absolute",top:"50%",left:"50%",color:"#fff",transform:"translate(-50%, -50%)",transition:"200ms",cursor:"pointer",fontSize:36,opacity:0,"&:hover":{opacity:1}}),onClick:e=>{e.stopPropagation(),A.current&&g((e=>!e))}}),r.createElement(ge.Z,{className:(0,R.iv)({position:"absolute",top:10,right:10,color:"#fff",cursor:"pointer",fontSize:20}),onClick:e=>{e.stopPropagation(),A.current&&(g(!1),i((0,c.setSettings)({fallbackVideo:void 0})))}})):r.createElement(fe.Z.Text,{type:"secondary",className:(0,R.cx)((0,R.iv)({display:"flex",cursor:"pointer",justifyContent:"center",flexDirection:"column",alignItems:"center",background:"#eee",borderRadius:4,rowGap:12,width:270,height:480}))},r.createElement(ve.Z,null),r.createElement("div",null,"上传视频")))))}var kt=n(32356),Ct=n(22142);function jt({getState:e,disabled:t,sceneMode:n,skinning:r,onSaving:a}){const l=(0,c.useHasUserPermission)("exportProject"),o=(0,S.FJ)("<export_project>");switch(n){case"Template":return Ct.createElement(Ct.Fragment,null,(!(0,he.cM)({release:!0})||l)&&Ct.createElement(Zt,{disabled:t,getState:e,onSaving:a}),(0,he.cM)({release:!0})&&Ct.createElement(se,{disabled:t,getState:e,onSaving:a}));case"Project":case"Product":return Ct.createElement(Ct.Fragment,null,(l||o)&&Ct.createElement(Zt,{disabled:t,getState:e,onSaving:a}),r?Ct.createElement(se,{skinning:!0,disabled:t,getState:e,onSaving:a}):Ct.createElement(kt.ZP,{disabled:t,getState:e,onSaving:a}))}}var It=n(92187),zt=n(9904),Lt=n(45858),Nt=n(55658),Vt=n(22142);function Dt(){const[e,t]=(0,r.useState)(!1),[n,a]=(0,It.Em)("changelog",{nextValue:"0.9.0",byStep:!1});let o=0;return Vt.createElement(f.Z,{overlay:Vt.createElement(A.Z,null,Vt.createElement(A.Z.Item,{key:o++,onClick:()=>{a(!1),(0,h.r3)(h.GM.OperationButton,{type:"更新日志"}),(0,he.cM)({online:!0})?window.open("https://bytedance.feishu.cn/docs/doccn8nDt4jSAE83zoibe09TYwc"):window.open("https://bytedance.feishu.cn/wiki/wikcn8s1H2JBm9PdWDFA0So1D8d")}},Vt.createElement(Lt.Z,{dot:n,offset:[2,-2]},"更新日志")),Vt.createElement(A.Z.Item,{key:o++,onClick:()=>{(0,h.r3)(h.GM.OperationButton,{type:"教程中心"}),(0,h.r3)(h.GM.Tutorial,{type:"帮助按钮"}),window.open("https://magicplay.oceanengine.com/tutorials/middle/seven")},className:(0,R.iv)({display:"flex",alignItems:"center"})},"教程中心",Vt.createElement("img",{style:{width:20,height:12,marginLeft:6},src:Nt})),Vt.createElement(A.Z.Item,{key:o++,onClick:()=>{(0,h.r3)(h.GM.OperationButton,{type:"示例项目"}),window.open(`${location.origin}/public`)}},"示例项目"),(0,he.cM)({release:!1})&&Vt.createElement(N.Z,{key:o++,accept:".zip",fileList:[],beforeUpload:e=>{t(!0);const n=new FormData;n.set("file",e),Pt(n).finally((()=>{t(!1)}))}},Vt.createElement(A.Z.Item,null,"上传Zip包到Ad平台"))),placement:"bottomLeft"},Vt.createElement(d.Z,{loading:e,dot:n,icon:Vt.createElement(l.Z,{component:zt.Z})},"帮助"))}var Bt=n(51828),Ft=n(69226),Tt=n(2564),Mt=n.p+"images/b931f00afe6aa338e080.png",Rt=n(21703),Wt=n(22142),Ut=({children:e})=>Wt.createElement(f.Z,{onOpenChange:e=>{e&&(0,Rt.r)(Rt.G.LookOncallService,null)},placement:"bottomLeft",overlay:Wt.createElement(Se.Z,{hoverable:!0,bodyStyle:{padding:16,width:200}},Wt.createElement("img",{alt:"二维码",src:Mt,style:{width:"100%",objectFit:"contain"}}),Wt.createElement(Tt.Z,{title:"互动编辑器服务台",description:Wt.createElement("div",{style:{whiteSpace:"normal",wordBreak:"break-all",wordWrap:"break-word"}},Wt.createElement("p",{style:{marginBottom:"3px"}},"1.飞书搜索",Wt.createElement("span",{style:{fontWeight:"bold",color:"#3452ff"}},"「PlayableMaker 服务台」"),"进行反馈"),Wt.createElement("p",null,"2.若无搜索结果，请扫上方二维码申请"))}))},Wt.createElement("div",null,e||Wt.createElement(d.Z,{icon:Wt.createElement(l.Z,{component:Ft.Z})},"服务台"))),qt=n(99317),Gt=n(88460);function Xt({disabled:e,onSaving:t}){const{getState:n}=(0,a.oR)();return r.createElement(d.Z,{icon:r.createElement(l.Z,{component:qt.Z}),disabled:e,onClick:()=>{return e=this,null,r=function*(){(0,h.r3)(h.GM.OperationButton,{type:"保存"});const{project:e}=n(),{id:r,editor:{selectedSceneId:a}}=e,l=(0,h.zh)(e);(0,Gt.J1)(r,a,l);try{yield t("保存");const e=(0,c.checkPlayableAreaAll)(n().project);e&&x.ZP.warning(`${e}，请及时检查是否影响互动效果`),x.ZP.success("保存成功")}catch(e){x.ZP.error(e.message||"保存失败")}},new Promise(((t,n)=>{var a=e=>{try{o(r.next(e))}catch(e){n(e)}},l=e=>{try{o(r.throw(e))}catch(e){n(e)}},o=e=>e.done?t(e.value):Promise.resolve(e.value).then(a,l);o((r=r.apply(e,null)).next())}));var e,r}},"保存")}var Jt=n(13718),Ht=n(22142),Kt=Object.defineProperty,Qt=Object.defineProperties,Yt=Object.getOwnPropertyDescriptors,$t=Object.getOwnPropertySymbols,_t=Object.prototype.hasOwnProperty,en=Object.prototype.propertyIsEnumerable,tn=(e,t,n)=>t in e?Kt(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,nn=(e,t,n)=>new Promise(((r,a)=>{var l=e=>{try{i(n.next(e))}catch(e){a(e)}},o=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,o);i((n=n.apply(e,t)).next())})),rn=(0,r.memo)((({onSaving:e})=>{const{panoramaEdit:t,onChange:n}=(0,c.useEditor)(0,"panoramaEdit"),{settingsOn:r,onChange:u}=(0,c.useEditor)(0,"settingsOn"),{sceneMode:p}=(0,c.useEditor)(0,"sceneMode"),{readOnly:f}=(0,c.useEditor)(0,"readOnly"),{skinning:A}=(0,c.useEditor)(0,"skinning"),{loading:y}=(0,c.useEditor)(0,"loading"),{getState:g}=(0,a.oR)(),v=(0,c.useSettings)("typeOfPlay"),S=(0,c.useSettings)("category"),x=3===v&&3===S;return Ht.createElement("div",{className:(0,R.cx)(Bt.Z)},Ht.createElement("div",{className:(0,h.xG)({[`${Bt.Z}-content`]:1})},Ht.createElement("div",{className:`${Bt.Z}-img`,onClick:()=>{location.href.includes("from=rubeex")?location.href="/":location.href="/my/project"}},Ht.createElement("img",{src:s}))),Ht.createElement(E.Z,{disabled:y||f,readOnly:f}),4!==v&&!x&&Ht.createElement(w.Z,{options:[{label:"素材制作",value:"Project"},{label:"模板配置",value:"Template"},{label:"模板换肤",value:"Product"}]}),Ht.createElement("div",{className:(0,h.xG)({[`${Bt.Z}-content`]:3})},"Product"===p?Ht.createElement(m,{disabled:y}):Ht.createElement(Ht.Fragment,null,Ht.createElement("div",null,Ht.createElement(Ut,null)),Ht.createElement("div",null,Ht.createElement(Dt,null)),4!==v&&Ht.createElement(d.Z,{disabled:y,type:r?"primary":"default",icon:Ht.createElement(l.Z,{component:o.Z}),onClick:()=>{var e;u(!r,!0),n((e=((e,t)=>{for(var n in t||(t={}))_t.call(t,n)&&tn(e,n,t[n]);if($t)for(var n of $t(t))en.call(t,n)&&tn(e,n,t[n]);return e})({},t),Qt(e,Yt({type:void 0})))),(0,h.r3)(h.GM.OperationButton,{type:"全局"})}},"全局")),Ht.createElement("div",{className:(0,R.iv)({display:"flex"}),id:Jt._z},Ht.createElement(P.Z,{disabled:y,getState:g,onSaving:e}),!f&&Ht.createElement(Xt,{disabled:y,onSaving:e}),f&&(0,he.cM)({release:!0})&&Ht.createElement(d.Z,{icon:Ht.createElement(l.Z,{component:i.Z}),disabled:y,onClick:()=>nn(void 0,null,(function*(){var e;(0,h.r3)(h.GM.OperationButton,{type:"另存版本"}),yield(e=g().project.id,nn(void 0,null,(function*(){const{data:{data:{pid:t,id:n,type:r}}}=yield M.dJ.post("project/saveAs",{id:e}),a=new URL(location.href),l=String(location.search.includes("from=rubeex")?t:n);a.pathname=a.pathname.replace(/\d+/,l),a.searchParams.set("type",String(r)),a.searchParams.delete("readonly"),a.searchParams.get("id")&&a.searchParams.set("id",l),location.href=a.href})))}))},"另存版本"),Ht.createElement(jt,{disabled:y,skinning:A,sceneMode:p,getState:g,onSaving:e})),Ht.createElement(b,null)))})),an=n(31934),ln=n(37285),on=n(33261),cn=n(80863),sn=n(25546),dn=n(76566),un=n(22142),pn=({changed:e,readOnly:t,onReturn:n})=>{const{token:r}=rt.Z.useToken(),o=(0,a.v9)((({project:e})=>Array.from(function*t(n){var r;yield"PanoramaData"===n.type?(0,dn.y_)(e)?"":"全景空间":null!=(r=null==n?void 0:n.scenes[0].name)?r:"未命名",n.editor.prevState&&(yield*t(n.editor.prevState))}(e)).reverse()),a.wU).filter((e=>""!==e));return un.createElement("div",{style:{zIndex:99,marginLeft:"10px",alignItems:"center",justifyContent:"center",display:"flex"}},un.createElement(on.Z,{separator:">",style:{marginRight:"10px"}},o.map(((e,t)=>un.createElement(on.Z.Item,{key:t,onClick:()=>{const e=o.length-1-t;e>0&&n(e)}},0===t?un.createElement(V.Z,{type:"primary",size:"small"},"返回项目"):e)))),e&&un.createElement(l.Z,{component:sn.Z,style:{color:r.colorPrimary}}),t&&un.createElement(cn.Z,{color:r.colorPrimary},"只读"))},mn=n(22142),fn=(0,r.memo)((()=>{const{readOnly:e}=(0,c.useEditor)(0,"readOnly"),{loading:t}=(0,c.useEditor)(0,"loading"),{playing:n}=(0,c.useEditor)(0,"playing"),r=(0,c.useProject)("id"),a=(0,c.useScene)("orderId"),{changed:l,onReturn:o}=(0,ln.Z)(Boolean(r&&a));return mn.createElement("div",{className:Bt.Z},mn.createElement(pn,{changed:l,readOnly:e,onReturn:o}),mn.createElement(w.Z,{disabled:t,options:[{label:"编辑组件模式",value:"Project"},{label:"设置属性模式",value:"Template"}]}),mn.createElement("div",{className:(0,h.xG)({[`${Bt.Z}-content`]:3})},!e&&mn.createElement(an.ZP,{publish:!0,disabled:n>0,changed:l},"发布"),0!==r&&mn.createElement(mn.Fragment,null,mn.createElement(an.ZP,{saveAs:!0,disabled:n>0,changed:l},"另存为"),0!==a&&mn.createElement(an.ZP,{disabled:n>0,changed:l},"保存并返回"))))})),An=(0,r.memo)((()=>{const{readOnly:e}=(0,c.useEditor)(0,"readOnly"),{playing:t}=(0,c.useEditor)(0,"playing"),n=(0,c.useProject)("id"),a=(0,c.useScene)("orderId"),{changed:l,onReturn:o}=(0,ln.Z)(Boolean(n&&a));return r.createElement("div",{className:Bt.Z},r.createElement(pn,{changed:l,readOnly:e,onReturn:o}),r.createElement("div",{className:(0,h.xG)({[`${Bt.Z}-content`]:3})},!e&&r.createElement(an.ZP,{publish:!0,disabled:t>0,changed:l},"发布"),0!==n&&r.createElement(r.Fragment,null,r.createElement(an.ZP,{saveAs:!0,disabled:t>0,changed:l},"另存为"),0!==a&&r.createElement(an.ZP,{disabled:t>0,changed:l},"保存并返回"))))})),yn=n(26494),gn=n(22669),vn=(0,r.memo)((({children:e,changed:t,disabled:n})=>{const l=(0,gn.qw)(),o=(0,gn.kS)(),i=(0,gn.an)(),s=(0,gn.Bk)(),d=(0,gn.PF)(),[u,p]=(0,r.useState)(!1),{dispatch:m,getState:f}=(0,a.oR)(),A=(0,yn.Z)((()=>{return void 0,null,e=function*(){var e;const n=yield i();let r=n.editor.prevState;if(r)try{if(t){p(!0);const e=yield o();0!==e.length&&(r=l(n,e).editor.prevState,yield s()),p(!1)}}catch(t){x.ZP.error((null==(e=null==t?void 0:t.data)?void 0:e.message)||(null==t?void 0:t.message)||t),p(!1)}finally{m((0,c.restoreState)(r)),m((0,c.changeCategory)("")),m((0,c.setSettings)({store:f().project.settings.store})),d({enabled:!1}),p(!1)}},new Promise(((t,n)=>{var r=t=>{try{l(e.next(t))}catch(e){n(e)}},a=t=>{try{l(e.throw(t))}catch(e){n(e)}},l=e=>e.done?t(e.value):Promise.resolve(e.value).then(r,a);l((e=e.apply(undefined,null)).next())}));var e}));return r.createElement(V.Z,{style:{marginLeft:"8px"},size:"large",disabled:n,type:"primary",loading:u,onClick:A},e)})),hn=(0,r.memo)((()=>{const{readOnly:e}=(0,c.useEditor)(0,"readOnly"),{playing:t}=(0,c.useEditor)(0,"playing"),n=(0,c.useProject)("id"),a=(0,c.useScene)("orderId"),{changed:l,onReturn:o}=(0,ln.Z)(Boolean(n&&a));return r.createElement("div",{className:Bt.Z},r.createElement(pn,{changed:l,readOnly:e,onReturn:o}),r.createElement("div",{className:(0,h.xG)({[`${Bt.Z}-content`]:3})},r.createElement(vn,{disabled:t>0,changed:l},"保存并返回")))})),bn=n(33647),En=n(37041),wn=n(41650),Pn=Object.defineProperty,Sn=Object.defineProperties,xn=Object.getOwnPropertyDescriptors,Zn=Object.getOwnPropertySymbols,On=Object.prototype.hasOwnProperty,kn=Object.prototype.propertyIsEnumerable,Cn=(e,t,n)=>t in e?Pn(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,jn=(e,t)=>{for(var n in t||(t={}))On.call(t,n)&&Cn(e,n,t[n]);if(Zn)for(var n of Zn(t))kn.call(t,n)&&Cn(e,n,t[n]);return e},In=(e,t)=>Sn(e,xn(t)),zn=(e,t,n)=>new Promise(((r,a)=>{var l=e=>{try{i(n.next(e))}catch(e){a(e)}},o=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,o);i((n=n.apply(e,t)).next())}));function Ln(){const{getState:e,dispatch:t}=(0,a.oR)(),n=(0,c.useEmitter)("CleanIndexedDB");return r.createElement("div",{className:Bt.Z,style:{display:"flex",alignContent:"center",justifyContent:"flex-start"}},r.createElement("div",{style:{flexBasis:164,padding:"20px 32px",textAlign:"center",fontWeight:500,fontSize:16}},"历史记录"),r.createElement("div",{style:{marginRight:"auto",display:"flex",alignItems:"center"}},r.createElement(bn.Z,{title:"确定直接返回吗？（选中的历史版本不会被应用）",onConfirm:()=>{const{project:n}=e(),{prevState:r}=n.editor;t(r?(0,c.restoreState)(In(jn({},r),{type:"Project",editor:In(jn({},r.editor),{readOnly:!1})})):(0,c.restoreState)(In(jn({},n),{type:"Project",editor:In(jn({},n.editor),{readOnly:!1})})))},okText:"确定",cancelText:"取消"},r.createElement(V.Z,{type:"text",icon:r.createElement(l.Z,{component:En.Z})},"返回项目"))),r.createElement("div",{style:{display:"flex",alignItems:"center"}},r.createElement(Z.Z,{title:"清空当前场景的所有历史版本"},r.createElement(V.Z,{type:"text",icon:r.createElement(l.Z,{component:wn.Z}),onClick:()=>zn(this,null,(function*(){const{project:t}=e(),{project:{editor:{selectedSceneId:r}}}=e();yield(0,Gt.fI)(t.id,r),n(r)}))},"清空场景记录",r.createElement(l.Z,{component:zt.Z}))),r.createElement(Z.Z,{title:"清空当前项目的所有历史版本"},r.createElement(V.Z,{type:"text",icon:r.createElement(l.Z,{component:wn.Z}),onClick:()=>zn(this,null,(function*(){const{project:t}=e();yield(0,Gt.hv)(t.id),n(0)}))},"清空项目记录",r.createElement(l.Z,{component:zt.Z})))),r.createElement(V.Z,{onClick:()=>zn(this,null,(function*(){const{project:n}=e(),r=n.editor,{prevState:a}=r,l=((e,t)=>{var n={};for(var r in e)On.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&Zn)for(var r of Zn(e))t.indexOf(r)<0&&kn.call(e,r)&&(n[r]=e[r]);return n})(r,["prevState"]),o=(0,Gt.H7)(n,n.editor.selectedSceneId);o&&(0,Gt.J1)(n.id,o.id,o),t((0,c.restoreState)(In(jn({},n),{type:"Project",editor:In(jn({},l),{readOnly:!1})})))})),style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)"}},"应用此版本"))}var Nn=n(93422),Vn=n(34043),Dn=(0,r.memo)((()=>{const{getState:e}=(0,a.oR)(),t=(0,c.useProject)("type"),{onSaving:n}=(0,Nn.ZP)(),{onSaving:l}=(0,gn.EV)(),o=(0,dn.Yt)(e().project);if((0,Nn.Yj)(o?l:n),o)return r.createElement(rn,{onSaving:l});switch(t){case"Project":return r.createElement(rn,{onSaving:n});case"Component":return r.createElement(fn,null);case"PanoramaData":return r.createElement(hn,null);case"Model":case"Particle3D":return r.createElement(An,null);default:return r.createElement(Ln,null)}}))},93955:function(e,t,n){n.d(t,{z:function(){return p}});var r,a,l,o,i,c=n(22142),s=["title","titleId"];function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},d.apply(this,arguments)}var u=function(e,t){var n=e.title,u=e.titleId,p=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,s);return c.createElement("svg",d({width:20,height:20,viewBox:"0 0 20 20",fill:"none",xmlns:"http://www.w3.org/2000/svg",ref:t,"aria-labelledby":u},p),n?c.createElement("title",{id:u},n):null,r||(r=c.createElement("path",{d:"M4.58331 14.583V17.083C4.58331 17.7734 5.14296 18.333 5.83331 18.333H14.1666C14.857 18.333 15.4166 17.7734 15.4166 17.083V14.583",fill:"none",stroke:"currentColor",strokeWidth:1.25,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"1.25 2.5"})),a||(a=c.createElement("path",{d:"M15.4166 4.16699V2.91699C15.4166 2.22664 14.857 1.66699 14.1666 1.66699H5.83331C5.14296 1.66699 4.58331 2.22664 4.58331 2.91699V4.16699",fill:"none",stroke:"currentColor",strokeWidth:1.25,strokeLinecap:"round",strokeLinejoin:"round",strokeDasharray:"1.25 2.5"})),l||(l=c.createElement("path",{d:"M15.4166 4.16699V15.8337M4.58331 15.8337V4.16699",stroke:"currentColor",strokeWidth:1.25})),o||(o=c.createElement("path",{d:"M2.5 4.16699L17.5 4.16699",stroke:"currentColor",strokeWidth:1.25,strokeLinecap:"round",strokeLinejoin:"round"})),i||(i=c.createElement("path",{d:"M2.5 15.833L17.5 15.833",stroke:"currentColor",strokeWidth:1.25,strokeLinecap:"round",strokeLinejoin:"round"})))},p=(0,c.forwardRef)(u);n.p},66769:function(e,t,n){n.d(t,{Z:function(){return s}});var r=n(22142),a=n(79385),l=n(58042),o=n(89591),i=n(51514),c=n(22142),s=()=>{const[e,t]=(0,r.useState)(),{logined:n}=(0,i.Pc)();return(0,r.useEffect)((()=>{var e;n&&(void 0,null,e=function*(){var e,n;const r=yield(l={page:1,pageSize:1},((e,t,n)=>new Promise(((r,a)=>{var l=e=>{try{i(n.next(e))}catch(e){a(e)}},o=e=>{try{i(n.throw(e))}catch(e){a(e)}},i=e=>e.done?r(e.value):Promise.resolve(e.value).then(l,o);i((n=n.apply(e,t)).next())})))(void 0,null,(function*(){let e=`page:${l.page},\n      pageSize: ${l.pageSize},\n      sort: "updatedAt",\n      sortDirection: -1\n      `;l.status&&(e+=`status:${l.status}`),l.userId&&(e+=`userId:"${l.userId}"`);const t=a.gql`
    {
      listNoticeItem(${e}) {
        totalCount    
        list{
          id
          title
          content
          status
          userId
          updatedAt
          }
        }
      }
    `;return yield(0,a.request)(`${location.origin}/api/graphql`,t).then((e=>e.listNoticeItem))})));var l;const o=null==(e=null==r?void 0:r.list)?void 0:e[0],i=null!=(n=localStorage.getItem("noticeId"))?n:"0";(null==o?void 0:o.id)===i||1===(null==o?void 0:o.status)||t(o)},new Promise(((t,n)=>{var r=t=>{try{l(e.next(t))}catch(e){n(e)}},a=t=>{try{l(e.throw(t))}catch(e){n(e)}},l=e=>e.done?t(e.value):Promise.resolve(e.value).then(r,a);l((e=e.apply(undefined,null)).next())})))}),[n]),(0,r.useEffect)((()=>{const n=(0,l.eI)({url:`wss://${location.host}/api/graphql`}),r=n.subscribe({query:"\n        subscription {\n          noticeItemUpdated{\n            id\n            content\n            status\n          }\n        }\n      "},{next:n=>{const r=n.data.noticeItemUpdated;0===r.status?t(r):r.id===(null==e?void 0:e.id)&&t(null)},error:e=>{console.log("subscribe error: ",e)},complete:()=>{console.log("subscribe complete: ")}}),a=n.subscribe({query:"\n        subscription {\n          noticeItemAdded {\n            id\n            content\n            status\n          }\n        }\n      "},{next:e=>{const n=e.data.noticeItemAdded;t(n)},error:e=>{console.log("subscribe error: ",e)},complete:()=>{console.log("subscribe complete: ")}});return()=>{r(),a()}}),[]),(null==e?void 0:e.content)?c.createElement(o.Z,{banner:!0,type:"info",message:null==e?void 0:e.content,closable:!0,afterClose:()=>{localStorage.setItem("noticeId",e.id)}},"hello"):null}}}]);